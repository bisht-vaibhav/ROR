{"paragraphs":[{"text":"spark.conf.set(\"spark.yarn.executor.memoryOverhead\", 8192)","dateUpdated":"2018-08-24T07:11:13+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1535094673796_1678923412","id":"20180212-121452_386712845","dateCreated":"2018-08-24T07:11:13+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3420"},{"text":"%pyspark\n\n# Import Libraries from Pyspark\nfrom pyspark.sql.functions import *\nfrom pyspark.sql.window import Window\nfrom pyspark.sql.types import *\nfrom datetime import datetime\nimport os","dateUpdated":"2018-08-24T07:11:13+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1535094673806_1676614918","id":"20170908-101959_1289946737","dateCreated":"2018-08-24T07:11:13+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3421"},{"text":"%md\n\n### Get Tracking Info\n","dateUpdated":"2018-08-24T07:11:13+0000","config":{"colWidth":12,"editorMode":"ace/mode/markdown","results":{},"enabled":true,"editorSetting":{"language":"markdown","editOnDblClick":true}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>Get Tracking Info</h3>\n"}]},"apps":[],"jobName":"paragraph_1535094673807_1676230169","id":"20180211-052427_326010424","dateCreated":"2018-08-24T07:11:13+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3422"},{"text":"%pyspark\n\n# schema for column headers \nschema_uri = r's3n://s3-helios-nissan-ml-poc/nissan-id/data/lookup/column_headers.tsv'\n\n# Loading from S3 : change the folder path for running full analysis \nhit_log_uri = r's3n://s3-helios-nissan-ml-poc/nissan-id/data/raw/*.tsv.gz'\n\n\ndef get_tracking_info(df, details=True):\n    aggregations = []\n    aggregations.append(count('post_evar61').alias('count'))\n    if details:\n        aggregations.append(min('date_time_ts').alias('min_time'))\n        aggregations.append(max('date_time_ts').alias('max_time'))\n    df.groupBy('post_evar61').agg(*aggregations).show(10, False)\n    \n\n# read schema\ndf_schema = spark.read.csv(schema_uri, sep='\\t', header=True)\n# creating custom schema : used to check and eliminate the Malformed rows \nfields = [StructField(field_name, StringType(), True) for field_name in df_schema.columns]\nschema = StructType(fields=fields)\nprint('Number of fields : {0}'.format(len(schema)))\n    \n# load data into spark\ndf = spark.read.csv(hit_log_uri,sep='\\t', encoding='ISO-8859-1',schema=schema) \n# get tracking info\nget_tracking_info(df, details=False)","dateUpdated":"2018-08-24T07:11:13+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Number of fields : 1005\n+----------------+-------+\n|post_evar61     |count  |\n+----------------+-------+\n|Helios|ID       |9681868|\n|Helios|undefined|2      |\n|null            |0      |\n|Helios|         |13     |\n+----------------+-------+\n\n"}]},"apps":[],"jobName":"paragraph_1535094673807_1676230169","id":"20171009-141200_131661301","dateCreated":"2018-08-24T07:11:13+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3423"},{"text":"%md\n\n### Data Processing","dateUpdated":"2018-08-24T07:11:13+0000","config":{"colWidth":12,"editorMode":"ace/mode/markdown","results":{},"enabled":true,"editorSetting":{"language":"markdown","editOnDblClick":true}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>Data Processing</h3>\n"}]},"apps":[],"jobName":"paragraph_1535094673807_1676230169","id":"20180211-052408_176409024","dateCreated":"2018-08-24T07:11:13+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3424"},{"text":"%pyspark\n\n# Specify URIs\n\n# schema for column headers \nschema_uri = r's3n://s3-helios-nissan-ml-poc/nissan-id/data/lookup/column_headers.tsv'\n\n# Loading from S3 : change the folder path for running full analysis \nhit_log_uri = r's3n://s3-helios-nissan-ml-poc/nissan-id/data/raw/*.tsv.gz'\n#hit_log_uri = r's3n://s3-helios-nissan-ml-poc/nissan-uk/data/sample/raw/*.tsv.gz'\n\n# write path for processed file\nparquet_write_file_path =  r's3n://s3-helios-nissan-ml-poc/nissan-id/data/processed/v1'\nlog_write_file_path =  r's3n://s3-helios-nissan-ml-poc/nissan-id/data/processed/v1_log'\n\n# post_evar61_filter : select tracking platform\npost_evar61_filters = ['Helios|ID']\n#post_evar61_filters = ['Helios|GB']\n","dateUpdated":"2018-08-24T07:11:13+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1535094673808_1686618390","id":"20171009-140706_1190370275","dateCreated":"2018-08-24T07:11:13+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3425"},{"text":"%pyspark\n\ndef get_processed_data(schema_uri, hit_log_uri,post_evar61_filters):\n    \n    # UDFs \n    # wrapper function for creating udfs\n    def udf_wrapper(returntype):\n        def udf_func(func):\n            return udf(func, returnType=returntype)\n        return udf_func\n        \n        \n     # sessionization\n    TIME_OUT = 30 # 30 minutes of timeout\n    \n        \n    @udf_wrapper(IntegerType())\n    def get_event_boundary(time_diff):\n        '''\n        based on the timeout value, return the event boundary\n        '''\n        if(time_diff is None):\n            return 0\n        else:\n            if(time_diff > TIME_OUT):\n                return 1\n            else:\n                return 0\n                \n    @udf_wrapper(FloatType())\n    def set_default_page_time(time_spent):\n        '''\n        based on the time spent, if if\n        '''\n        if(time_spent is None):\n            return 0.08 # 5 seconds \n        else:\n            return time_spent\n         \n    @udf_wrapper(StringType())   \n    def get_device_type(agent_str):\n        user_agent = parse(str(agent_str))\n        device_type = None\n        if user_agent.is_mobile:\n            device_type = 'mobile'\n        if user_agent.is_tablet:\n            device_type = 'tablet'\n        if user_agent.is_pc:\n            device_type = 'desktop'\n        if user_agent.is_bot:\n            device_type = 'bot'\n        return device_type\n    \n    # get schema\n    print('Get schema.')\n    df_schema = spark.read.csv(schema_uri, sep='\\t', header=True)\n    # creating custom schema : used to check and eliminate the Malformed rows \n    fields = [StructField(field_name, StringType(), True) for field_name in df_schema.columns]\n    schema = StructType(fields=fields)\n    print('Number of fields : {0}'.format(len(schema)))\n            \n    # load data into spark\n    df = spark.read.csv(hit_log_uri,sep='\\t', encoding='ISO-8859-1',schema=schema)\n    \n    \n    # ETL\n    if post_evar61_filters is not None:\n        df_processed = df.filter(col('post_evar61').isin(post_evar61_filters))\n    else:\n        df_processed = df\n    \n    # device type\n    # df_processed = df_processed.withColumn('device_type', get_device_type(col('user_agent')))\n    \n    df_processed = df_processed \\\n                     .withColumn('visitor_id',concat(col('post_visid_low'), lit(\"_\"), col('post_visid_high')))\\\n                     .withColumn('visit_unq',concat(col('post_visid_low'), lit(\"_\"), col('post_visid_high'), lit(\"_\"), col('visit_num')))\\\n                     .withColumn('hit_time_gmt_str', from_unixtime(col('hit_time_gmt')).cast('timestamp')) \\\n                     .select('accept_language','browser','country','visitor_id','visit_unq','visit_num','visit_page_num',\\\n                            'post_event_list','post_pagename','post_page_url',\\\n                            'post_page_event','post_zip','hit_source','exclude_hit',\\\n                            'hit_time_gmt_str','first_hit_page_url','first_hit_pagename',\\\n                             'first_hit_referrer','first_hit_time_gmt','ip',\\\n                            'last_hit_time_gmt','post_keywords','post_referrer','post_search_engine',\\\n                             'ref_domain','state','user_agent','weekly_visitor','yearly_visitor','visid_type','post_cust_hit_time_gmt','date_time',\\\n                             'post_evar4','post_evar5','post_evar6','post_evar7','post_evar8','post_evar9','post_evar20','post_evar19','post_evar21','post_evar22','post_evar29','post_evar30','post_evar32','post_evar34','post_evar39','post_evar40','post_evar41','post_evar48','post_evar54','post_evar61','post_evar64',\\\n                             'post_prop1','post_prop2','post_prop3','post_prop4','post_prop5','post_prop6','post_prop7','post_prop12','post_prop14','post_prop16','post_prop17','post_prop23','geo_country','geo_city')\n                             \n    \n    # Timestamp Conversion\n    ts_pattern_1 = 'yyyy-MM-dd HH:mm:ss'\n    date_pattern_1 = 'yyyy-MM-dd'\n    \n    \n    \n    df_processed = df_processed.withColumn('date_time_ts',unix_timestamp(col('date_time'), ts_pattern_1).cast('timestamp'))\\\n                         .withColumn('date_ts',from_unixtime(unix_timestamp(col('date_time'),ts_pattern_1),date_pattern_1).cast('timestamp'))\\\n                         .withColumn('success_event_201',col('post_event_list').like('{0}%'.format(201)).cast('integer')) \\\n                         .drop('date_time')\n                         \n    \n    # Sessionization\n    w0 = Window.partitionBy(col('visitor_id'))\n        \n    w1 = Window.partitionBy(col('visitor_id')).orderBy(col('date_time_ts'))\n    \n    w2 = Window.partitionBy(col('visitor_id'),col('session_id')).orderBy(col('date_time_ts').desc())\n        \n    w3 = Window.partitionBy(col('visitor_id'),col('session_id')).orderBy(col('date_time_ts'))\n        \n    df_processed  = df_processed \\\n                       .withColumn('is_converted', max(col('success_event_201')).over(w0)) \\\n                       .withColumn('prev', lag(col('date_time_ts'),1).over(w1)) \\\n                       .withColumn('time_diff',((col('date_time_ts').cast('long') - col('prev').cast('long'))/60.0)) \\\n                       .withColumn('new_event_boundary',get_event_boundary(col('time_diff'))) \\\n                       .withColumn('session_id', sum(col('new_event_boundary')).over(w1)) \\\n                       .drop('prev','time_diff','new_event_boundary')\n                       \n                    \n    # hit order\n    df_processed = df_processed.withColumn('hit_rank_reversed', dense_rank().over(w2))\n    \n    \n        \n    #Time Spent                      \n    df_processed = df_processed\\\n                        .withColumn('next', lead(col('date_time_ts'),1).over(w3)) \\\n                        .withColumn('time_diff',((col('next').cast('long') - col('date_time_ts').cast('long'))/60.0)) \\\n                        .withColumn('time_spent_in_mins',set_default_page_time(col('time_diff'))) \\\n                        .drop('next','time_diff')\n                        \n    \n    # Caching the dataframe \n    print('caching processed file started.')\n    df_processed.createOrReplaceTempView('df_processed_view')\n    spark.catalog.cacheTable('df_processed_view')\n    spark.table('df_processed_view').count()\n    df_hits = spark.table(\"df_processed_view\")\n    print('caching processed file completed.')\n    \n    print('Total number of hits in processed data : {0}'.format(df_hits.count()))\n    \n    return df_hits\n   \n     \n                        \n                     ","dateUpdated":"2018-08-24T07:11:13+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1535094673808_1686618390","id":"20170908-102450_1684615722","dateCreated":"2018-08-24T07:11:13+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3426"},{"text":"%pyspark\n\ndef write_processed_data(df_hits, hit_log_uri,parquet_write_file_path):\n    print('writing processed file to S3 started.')\n    df_hits.write.format('parquet').save(parquet_write_file_path)\n    print('writing processed file to S3 finished')\n    \n   \ndef write_log(df_hits, hit_log_uri,post_evar61_filters):\n     # Logs\n    #Setup Logs\n    logs = []\n    # Hit log uri\n    logs.append(('Hit Log URI', '{0}'.format(hit_log_uri)))\n    # tracking filter\n    if post_evar61_filters is not None:\n        logs.append(('Tracking filter', ','.join(post_evar61_filters)))\n    # Number of records\n    logs.append(('Number of Records', '{0}'.format(df_hits.count())))\n    # Number of columns\n    logs.append(('Number of Processed Columns', '{0}'.format(len(df_hits.columns))))\n    # column names\n    logs.append(('Columns', ','.join(df_hits.columns)))\n    # create RDD\n    logs_rdd = sc.parallelize(logs)\n    # create dataframe\n    df_logs = spark.createDataFrame(logs_rdd,['key','value'])\n    # write logs to the file\n    df_logs.coalesce(1).write.format('csv').save(log_write_file_path)\n    print('Write log file Completed')","dateUpdated":"2018-08-24T07:11:13+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1535094673809_1686233641","id":"20171019-112907_124258817","dateCreated":"2018-08-24T07:11:13+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3427"},{"text":"%md\n\n## Get Basic Processed Data","dateUpdated":"2018-08-24T07:11:13+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h2>Get Basic Processed Data</h2>\n"}]},"apps":[],"jobName":"paragraph_1535094673810_1687387887","id":"20171105-170311_1466414385","dateCreated":"2018-08-24T07:11:13+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3428"},{"text":"%pyspark\ndf_hits = get_processed_data(schema_uri, hit_log_uri,None)","dateUpdated":"2018-08-24T07:11:13+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Get schema.\nNumber of fields : 1005\ncaching processed file started.\ncaching processed file completed.\nTotal number of hits in processed data : 9759685\n"}]},"apps":[],"jobName":"paragraph_1535094673810_1687387887","id":"20170908-114637_1962444241","dateCreated":"2018-08-24T07:11:13+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3429"},{"text":"%pyspark\n# write basics features\nwrite_processed_data(df_hits, hit_log_uri,parquet_write_file_path)","dateUpdated":"2018-08-24T07:11:13+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"writing processed file to S3 started.\nwriting processed file to S3 finished\n"}]},"apps":[],"jobName":"paragraph_1535094673810_1687387887","id":"20171017-041501_1761654105","dateCreated":"2018-08-24T07:11:13+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3430"},{"text":"%pyspark\n# write basic logs\nwrite_log(df_hits, hit_log_uri, None)","dateUpdated":"2018-08-24T07:11:13+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Write log file Completed\n"}]},"apps":[],"jobName":"paragraph_1535094673811_1687003139","id":"20171019-115903_473949875","dateCreated":"2018-08-24T07:11:13+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3431"},{"text":"%md\n\n### Add Page Category","dateUpdated":"2018-08-24T07:11:13+0000","config":{"colWidth":12,"editorMode":"ace/mode/markdown","results":{},"enabled":true,"editorSetting":{"language":"markdown","editOnDblClick":true}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>Add Page Category</h3>\n"}]},"apps":[],"jobName":"paragraph_1535094673811_1687003139","id":"20180211-054014_1538674008","dateCreated":"2018-08-24T07:11:13+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3432"},{"text":"%pyspark\n# Loading processed file from S3 : change the folder path for running full analysis \nprocessed_uri = r's3n://s3-helios-nissan-ml-poc/nissan-id/data/processed/v1'\n","dateUpdated":"2018-08-24T07:11:13+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1535094673811_1687003139","id":"20171019-134216_1284094331","dateCreated":"2018-08-24T07:11:13+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3433"},{"text":"%pyspark\n\n# read the processed data \ndf_final = spark.read.parquet(processed_uri)\n# Caching the dataframe\ndf_final.createOrReplaceTempView('df_hits_view')\nspark.catalog.cacheTable('df_hits_view')\nspark.table('df_hits_view').count()\ndf_hits = spark.table(\"df_hits_view\")\nprint(df_hits.count())","dateUpdated":"2018-08-24T07:11:13+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"9759685\n"}]},"apps":[],"jobName":"paragraph_1535094673811_1687003139","id":"20171019-175450_1812185612","dateCreated":"2018-08-24T07:11:13+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3434"},{"text":"%pyspark\n# read page type \npage_type_uri = r's3n://s3-helios-nissan-ml-poc/nissan-id/data/lookup/page_name_category_mapping.csv'\ndf_page_name_mapping = spark.read.csv(page_type_uri, header=True)\ndf_page_name_mapping.printSchema()\ndict_page_name_mapping = {row['PageName']:row['Category'] for row in df_page_name_mapping.select('PageName','Category').collect()}","dateUpdated":"2018-08-24T07:11:13+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- PageName: string (nullable = true)\n |-- Category: string (nullable = true)\n\n"}]},"apps":[],"jobName":"paragraph_1535094673812_1685079394","id":"20171019-203019_747403634","dateCreated":"2018-08-24T07:11:13+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3435"},{"text":"%pyspark\n\nfrom user_agents import parse\n\n\n# wrapper function for creating udfs\ndef udf_wrapper(returntype):\n    def udf_func(func):\n        return udf(func, returnType=returntype)\n    return udf_func\n    \n@udf_wrapper(StringType())   \ndef get_device_type(agent):\n    if agent is not None:\n        agent_str = agent.encode('utf-8')\n        user_agent = parse(agent_str)\n        device_type = None\n        if user_agent.is_mobile:\n            device_type = 'mobile'\n        if user_agent.is_tablet:\n            device_type = 'tablet'\n        if user_agent.is_pc:\n            device_type = 'desktop'\n        if user_agent.is_bot:\n            device_type = 'bot'\n        return device_type\n    \n    else:\n        return None\n        \n\n@udf_wrapper(StringType())\ndef get_page_category(page_type):\n    '''\n    based on the page_type return page category\n    '''\n    if page_type is None:\n        return None\n    if page_type == 'null':\n        return None\n    if page_type in dict_page_name_mapping.keys():\n        return dict_page_name_mapping[page_type]\n    else:\n        return None\n        \n    \n    ","dateUpdated":"2018-08-24T07:11:13+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1535094673812_1685079394","id":"20171019-175512_1738620923","dateCreated":"2018-08-24T07:11:13+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3436"},{"text":"%pyspark\ndf_hits_new = df_hits.withColumn('page_category', get_page_category(col('post_pagename')))","dateUpdated":"2018-08-24T07:11:13+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1535094673812_1685079394","id":"20171020-040947_2087803798","dateCreated":"2018-08-24T07:11:13+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3437"},{"text":"%pyspark\nparquet_write_file_path =  r's3n://s3-helios-nissan-ml-poc/nissan-id/data/processed/v2'\ndf_hits_new.write.format('parquet').save(parquet_write_file_path)","dateUpdated":"2018-08-24T07:11:13+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1535094673813_1684694645","id":"20180211-054619_1621013633","dateCreated":"2018-08-24T07:11:13+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3438"},{"text":"%md\n\n### Add Device Type","dateUpdated":"2018-08-24T07:11:13+0000","config":{"colWidth":12,"editorMode":"ace/mode/markdown","results":{},"enabled":true,"editorSetting":{"language":"markdown","editOnDblClick":true}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>Add Device Type</h3>\n"}]},"apps":[],"jobName":"paragraph_1535094673813_1684694645","id":"20180211-054314_745537671","dateCreated":"2018-08-24T07:11:13+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3439"},{"text":"%pyspark\n\n# Loading processed file from S3 : change the folder path for running full analysis \nprocessed_uri = r's3n://s3-helios-nissan-ml-poc/nissan-id/data/processed/v2'\n\n# read the processed data\ndf_final = spark.read.parquet(processed_uri)\n\n# Caching the dataframe\ndf_final.createOrReplaceTempView('df_hits_view')\nspark.catalog.cacheTable('df_hits_view')\nspark.table('df_hits_view').count()\ndf_hits = spark.table(\"df_hits_view\")\nprint(df_hits.count())","dateUpdated":"2018-08-24T07:11:13+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"9759685\n"}]},"apps":[],"jobName":"paragraph_1535094673813_1684694645","id":"20171020-043752_1350910918","dateCreated":"2018-08-24T07:11:13+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3440"},{"text":"%pyspark\ndf_hits_new = df_hits.withColumn('device_type', get_device_type(col('user_agent')))","dateUpdated":"2018-08-24T07:11:13+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1535094673813_1684694645","id":"20171019-183655_865196454","dateCreated":"2018-08-24T07:11:13+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3441"},{"text":"%pyspark\n# Caching the dataframe\ndf_hits_new.createOrReplaceTempView('df_hits_new_view')\nspark.catalog.cacheTable('df_hits_new_view')\nspark.table('df_hits_new_view').count()","dateUpdated":"2018-08-24T07:11:13+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"9759685\n"}]},"apps":[],"jobName":"paragraph_1535094673814_1685848892","id":"20171019-210344_87012913","dateCreated":"2018-08-24T07:11:13+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3442"},{"text":"%pyspark\ndf_hits_final = spark.table(\"df_hits_new_view\")\nprint(df_hits_final.count())","dateUpdated":"2018-08-24T07:11:13+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"9759685\n"}]},"apps":[],"jobName":"paragraph_1535094673814_1685848892","id":"20171030-085008_495750561","dateCreated":"2018-08-24T07:11:13+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3443"},{"text":"%pyspark\n\ndf_hits_final.select('device_type').groupBy('device_type').count().orderBy(col('count').desc()).show(20, False)","dateUpdated":"2018-08-24T07:11:13+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----------+-------+\n|device_type|count  |\n+-----------+-------+\n|mobile     |6036700|\n|desktop    |3310030|\n|tablet     |349920 |\n|null       |62595  |\n|bot        |440    |\n+-----------+-------+\n\n"}]},"apps":[],"jobName":"paragraph_1535094673814_1685848892","id":"20171020-080032_492146242","dateCreated":"2018-08-24T07:11:13+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3444"},{"text":"%pyspark\nparquet_write_file_path =  r's3n://s3-helios-nissan-ml-poc/nissan-id/data/processed/v3'\ndf_hits_final.write.format('parquet').save(parquet_write_file_path)","dateUpdated":"2018-08-24T07:11:13+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1535094673815_1685464143","id":"20171019-183827_1893997978","dateCreated":"2018-08-24T07:11:13+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3445"},{"text":"%pyspark\ndf_hits_final.columns","dateUpdated":"2018-08-24T07:11:13+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"['accept_language', 'browser', 'country', 'visitor_id', 'visit_unq', 'visit_num', 'visit_page_num', 'post_event_list', 'post_pagename', 'post_page_url', 'post_page_event', 'post_zip', 'hit_source', 'exclude_hit', 'hit_time_gmt_str', 'first_hit_page_url', 'first_hit_pagename', 'first_hit_referrer', 'first_hit_time_gmt', 'ip', 'last_hit_time_gmt', 'post_keywords', 'post_referrer', 'post_search_engine', 'ref_domain', 'state', 'user_agent', 'weekly_visitor', 'yearly_visitor', 'visid_type', 'post_cust_hit_time_gmt', 'post_evar4', 'post_evar5', 'post_evar6', 'post_evar7', 'post_evar8', 'post_evar9', 'post_evar20', 'post_evar19', 'post_evar21', 'post_evar22', 'post_evar29', 'post_evar30', 'post_evar32', 'post_evar34', 'post_evar39', 'post_evar40', 'post_evar41', 'post_evar48', 'post_evar54', 'post_evar61', 'post_evar64', 'post_prop1', 'post_prop2', 'post_prop3', 'post_prop4', 'post_prop5', 'post_prop6', 'post_prop7', 'post_prop12', 'post_prop14', 'post_prop16', 'post_prop17', 'post_prop23', 'geo_country', 'geo_city', 'date_time_ts', 'date_ts', 'success_event_201', 'is_converted', 'session_id', 'hit_rank_reversed', 'time_spent_in_mins', 'page_category', 'device_type']\n"}]},"apps":[],"jobName":"paragraph_1535094673815_1685464143","id":"20180211-071611_598644644","dateCreated":"2018-08-24T07:11:13+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3446"},{"text":"%md\n\n### Booked Test Drive Car Model","dateUpdated":"2018-08-24T07:11:13+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>Booked Test Drive Car Model</h3>\n"}]},"apps":[],"jobName":"paragraph_1535094673815_1685464143","id":"20171104-052036_368646789","dateCreated":"2018-08-24T07:11:13+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3447"},{"text":"%pyspark\n# Loading processed file from S3 : change the folder path for running full analysis \nprocessed_uri = r's3n://s3-helios-nissan-ml-poc/nissan-id/data/processed/v3'\n\n# read the processed data \ndf_final = spark.read.parquet(processed_uri)\n\n# Caching the dataframe\ndf_final.createOrReplaceTempView('df_hits_view')\nspark.catalog.cacheTable('df_hits_view')\nspark.table('df_hits_view').count()\ndf_hits = spark.table(\"df_hits_view\")\nprint(df_hits.count())","dateUpdated":"2018-08-24T07:11:13+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"9759685\n"}]},"apps":[],"jobName":"paragraph_1535094673815_1685464143","id":"20171020-102455_685564411","dateCreated":"2018-08-24T07:11:13+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3448"},{"text":"%pyspark\n\ndf_car_models = df_hits.select('post_evar6','success_event_201').filter(col('success_event_201') == 1).groupBy('post_evar6').count()\n\ndf_car_models.createOrReplaceTempView('df_car_models_view')","dateUpdated":"2018-08-24T07:11:13+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1535094673816_1683540398","id":"20171104-053059_1169579831","dateCreated":"2018-08-24T07:11:13+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3449"},{"text":"%pyspark\nfrom pyspark.sql.functions import mean, min, max\n\ndf_hits.select([max('date_time_ts'), min('date_time_ts')]).show()\n","dateUpdated":"2018-08-24T07:11:13+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------------------+-------------------+\n|  max(date_time_ts)|  min(date_time_ts)|\n+-------------------+-------------------+\n|2018-01-30 23:59:55|2017-03-13 00:00:09|\n+-------------------+-------------------+\n\n"}]},"apps":[],"jobName":"paragraph_1535094673816_1683540398","id":"20180315-163425_1017700454","dateCreated":"2018-08-24T07:11:13+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3450"},{"text":"%sql\n\nselect * from df_car_models_view\norder by count desc","dateUpdated":"2018-08-24T07:11:13+0000","config":{"colWidth":12,"editorMode":"ace/mode/sql","results":{},"enabled":true,"editorSetting":{"language":"sql","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"post_evar6\tcount\nP32R\t110\nR11Q\t85\nC26\t60\nB02A\t50\nH60A\t37\nP12C\t27\nX11M\t21\nJ42H\t14\nE1B\t10\n"}]},"apps":[],"jobName":"paragraph_1535094673816_1683540398","id":"20171109-172050_501219843","dateCreated":"2018-08-24T07:11:13+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3451"},{"text":"%pyspark\n# read car model type \ncar_model_mapping_uri = r's3n://s3-helios-nissan-ml-poc/nissan-id/data/lookup/vehicle_id_car_model_mapping.csv'\ndf_car_model_mapping = spark.read.csv(car_model_mapping_uri, header=True)\ndf_car_model_mapping.printSchema()\ndict_car_model_mapping = {row['vehicle_id']:row['car_model'] for row in df_car_model_mapping.select('vehicle_id','car_model').collect()}\ndict_car_model_mapping\n","dateUpdated":"2018-08-24T07:11:13+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- vehicle_id: string (nullable = true)\n |-- car_model: string (nullable = true)\n\n{u'C26': u'serena', u'P32R': u'xtrail', u'J42H': u'elgrand', u'H60A': u'navara', u'P12C': u'juke', u'B02A': u'march', u'R11Q': u'livina', u'X11M': u'evalia', u'E1B': u'teana'}\n"}]},"apps":[],"jobName":"paragraph_1535094673817_1683155650","id":"20171104-053732_311249777","dateCreated":"2018-08-24T07:11:13+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3452"},{"text":"%pyspark\n\n\n# wrapper function for creating udfs\ndef udf_wrapper(returntype):\n    def udf_func(func):\n        return udf(func, returnType=returntype)\n    return udf_func\n\n        \n\n@udf_wrapper(StringType())\ndef get_booked_car_model(is_converted,success_event_201,vehicle_id):\n    '''\n    based on the page_type return page category\n    '''\n    if (is_converted == 1):\n        if (success_event_201 == 1):\n            if vehicle_id is None:\n                return None\n            if vehicle_id == 'null':\n                return None\n            if vehicle_id in dict_car_model_mapping.keys():\n                return dict_car_model_mapping[vehicle_id]\n            else:\n                return None\n    else:\n        return None\n       \n        ","dateUpdated":"2018-08-24T07:11:13+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1535094673817_1683155650","id":"20171104-055812_1766707888","dateCreated":"2018-08-24T07:11:13+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3453"},{"text":"%pyspark\ndf_hits_with_booked_car_model = df_hits.withColumn('booked_car_model', get_booked_car_model(col('is_converted'),col('success_event_201'),col('post_evar6')))","dateUpdated":"2018-08-24T07:11:13+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1535094673817_1683155650","id":"20171104-060953_333506943","dateCreated":"2018-08-24T07:11:13+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3454"},{"text":"%pyspark\ndf_booked_cars = df_hits_with_booked_car_model.select('booked_car_model').groupBy('booked_car_model').count()\ndf_booked_cars.createOrReplaceTempView('df_booked_cars_view')","dateUpdated":"2018-08-24T07:11:13+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1535094673817_1683155650","id":"20171104-062108_669308203","dateCreated":"2018-08-24T07:11:13+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3455"},{"text":"%sql\nselect * from df_booked_cars_view","dateUpdated":"2018-08-24T07:11:13+0000","config":{"colWidth":12,"editorMode":"ace/mode/sql","results":{},"enabled":true,"editorSetting":{"language":"sql","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"booked_car_model\tcount\nnavara\t37\nxtrail\t110\nserena\t60\nnull\t9759271\nlivina\t85\nelgrand\t14\nevalia\t21\nteana\t10\njuke\t27\nmarch\t50\n"}]},"apps":[],"jobName":"paragraph_1535094673817_1683155650","id":"20171104-063834_711153463","dateCreated":"2018-08-24T07:11:13+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3456"},{"text":"%pyspark\ndf_hits_with_booked_car_model.filter(col('is_converted') == 1).filter(col('booked_car_model').isNotNull()).filter(col('success_event_201') == 1).select('visitor_id','booked_car_model').groupBy('visitor_id','booked_car_model').count().orderBy(col('count').desc()).show(1000, False)","dateUpdated":"2018-08-24T07:11:13+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---------------------------------------+-----------------+-----+\n|visitor_id                             |booked_car_model |count|\n+---------------------------------------+-----------------+-----+\n|8189216412116469441_7536395945900584875|Juke             |8    |\n|8534896281263279012_4127737268919759672|Note             |7    |\n|8612058435594080265_3054821820225326998|X-Trail          |6    |\n|4662709644988160517_7085843061577801435|X-Trail          |4    |\n|7951804968394311487_8921882589765142120|Navara_Double_Cab|4    |\n|8343020136494940911_3434793003321111066|X-Trail          |4    |\n|5928599944235952492_7263282711542929885|Pulsar           |4    |\n|6917532333692168905_3155735325425972171|Note             |4    |\n|6960528223329935157_8015563020842325649|X-Trail          |4    |\n|3972011364451353532_5902197589493792945|X-Trail          |4    |\n|363672615384476843_6201592309599225041 |Note             |4    |\n|3646747779144510672_6758695103179850558|Navara_Double_Cab|3    |\n|6345823929115411349_493464155206509162 |Note             |3    |\n|827035128149865843_3348063526941481144 |Note             |3    |\n|3622089158247495646_1290028968152982311|X-Trail          |3    |\n|6808520679196688621_9099876125972961186|Navara_Double_Cab|3    |\n|5210472221567922041_1337412334451628841|X-Trail          |3    |\n|6345513803487552520_5471905426735454316|Almera           |3    |\n|3717873426257536630_7243993767981756807|Navara_Double_Cab|3    |\n|293802116819147784_4194818519737920342 |Sylphy           |3    |\n|4686494258475350291_4680186515799575795|X-Trail          |3    |\n|5916102410350664852_940558137040453775 |Note             |3    |\n|5677094158100627051_2706228638316229113|Teana            |3    |\n|5184375710855441062_8397981006120907769|X-Trail          |3    |\n|6199451906161550286_1507181026406166322|Note             |3    |\n|2952211578911516519_3165143915555410061|Teana            |2    |\n|3852815761974867473_8942422517045118074|Note             |2    |\n|5800270950385175397_6396701874989902829|Note             |2    |\n|6618977797721218352_5455869152457756658|Note             |2    |\n|5622845085992758161_5053559997729213487|Sylphy           |2    |\n|4910542197712142008_4230397336145758263|Note             |2    |\n|1136142149753732070_5765311586567127376|Note             |2    |\n|7305041029635481208_864921869242149775 |X-Trail          |2    |\n|516957865914053982_3135973992324764065 |March            |2    |\n|1313113712606648506_2995140303253842771|X-Trail          |2    |\n|4611687152836008790_3129281223838020119|X-Trail          |2    |\n|1590210736536157132_2130428359375804038|X-Trail          |2    |\n|2042450517218346656_7165203320362389843|X-Trail          |2    |\n|4611687163036176099_3105523891413068778|X-Trail          |2    |\n|1430793377784774933_2535864047115671716|Almera           |2    |\n|4226995097817187156_2799349479827609838|Navara_Single_Cab|2    |\n|1387465261014289518_777403885372653212 |Note             |2    |\n|8915581550128598023_1250515568950425560|Pulsar           |2    |\n|1062114010187388653_7146232267393857789|Livina           |2    |\n|402998613853491114_8422727082403587933 |Note             |2    |\n|7434568518788671661_5468773934566545967|X-Trail          |2    |\n|8434463289861041049_348751014514311463 |Note             |2    |\n|118240528577612468_2196606358063972504 |Note             |2    |\n|4611689325552206670_3163724437042927009|Almera           |2    |\n|8555210903915090011_4450679971222833293|Note             |2    |\n|6006326671403153889_3288971638442608744|Juke             |2    |\n|291222986441167298_7295693639864134748 |Juke             |2    |\n|2401400295762088603_7316906683124616335|Livina           |2    |\n|5163271397142502826_2296238054966427549|Navara_Double_Cab|2    |\n|7227830918893939288_8249611304305309186|Note             |2    |\n|7164270810944850499_6404431558735349350|X-Trail          |2    |\n|4060119833878145985_1872133214679901541|Note             |2    |\n|7404220956794147115_8227875185588631284|Note             |2    |\n|3787534164928101959_7722356704428882034|Note             |2    |\n|2597920272535063724_1063322588494340910|Teana            |2    |\n|6732879691866024176_4213545795870132492|March            |2    |\n|3614853529119096084_1848210908268209534|Almera           |2    |\n|7341324546210567333_3282682385856997132|Livina           |2    |\n|1980770398847353691_7094366777729489373|X-Trail          |2    |\n|6339089510917931578_2501663088811581324|Almera           |2    |\n|7434653109561781966_1742978396727552270|Almera           |2    |\n|4957009775302575407_4217756098476534994|X-Trail          |2    |\n|6320335686893973605_6048574975646830670|X-Trail          |2    |\n|5705513246680925332_3265044769832140635|Navara_King_Cab  |2    |\n|5306288249890494336_4516655087159195894|Note             |2    |\n|4611705280281984214_3190716012983159000|Note             |2    |\n|1199507315687693789_2953734578373807554|Note             |2    |\n|8224613480765069290_1144046508523115931|Almera           |2    |\n|7169574917512057834_3532937103347762337|Livina           |2    |\n|3029636664474136423_592896785505767140 |Teana            |2    |\n|4441153821026591178_8778409544508209772|March            |2    |\n|1244273598952191803_7075019368212682165|Note             |2    |\n|4611687362752218893_3053169567217031831|X-Trail          |2    |\n|6917530157217647253_3166855122456810926|Teana            |2    |\n|4959101263436240001_1098295897975007670|Almera           |2    |\n|1842375043583899091_5834211720076133724|Almera           |2    |\n|844247972259134700_2768149353260583495 |Note             |2    |\n|4558805311881168080_797735432958533814 |Sylphy           |2    |\n|4759916210375967169_3973048228671112565|Navara_Single_Cab|2    |\n|5136403151204273902_8709840927967538705|X-Trail          |2    |\n|3192388526902807309_4804951487561771840|Note             |2    |\n|994844568955138238_3789801564764902457 |X-Trail          |2    |\n|2487416062925710226_5041224825954151391|Navara_King_Cab  |2    |\n|4611692619792733172_3140879838854332785|Juke             |2    |\n|6696366452445827842_6040925143589771490|X-Trail          |2    |\n|7673750810763134234_6262569260467986292|Note             |2    |\n|8083441509941419154_4361292115089090744|Note             |2    |\n|6917532333155298475_3211820266802553708|Note             |2    |\n|2377937721759072776_2082478580179340988|X-Trail          |2    |\n|4171119573658055397_89040555169213778  |Navara_King_Cab  |2    |\n|4017209840170110327_2918645307009078942|Sylphy           |2    |\n|2117075025935953562_968584252997818629 |Livina           |2    |\n|2255555958819726910_1323444977571736025|Note             |2    |\n|5783390617996963809_8831655567643472442|Navara_Single_Cab|2    |\n|6092925061934710919_4787869512378590877|Teana            |2    |\n|1179554904197921381_1484982605389466752|X-Trail          |2    |\n|4458485720091682583_577807107110415299 |March            |2    |\n|2043871557986411664_5871270397125449233|X-Trail          |2    |\n|3188474361222565325_1609648202513220759|Sylphy           |2    |\n|2084352454583412920_405597136906635067 |X-Trail          |2    |\n|4348913623344540251_435687138297446089 |Juke             |2    |\n|3282684123053468431_4971492144355172399|Juke             |2    |\n|3632691275378711337_3176816767862554783|X-Trail          |2    |\n|8103848844518379387_6484806165046521779|Note             |2    |\n|8400811709621253936_3229889668725267012|March            |2    |\n|363672615384476843_6201592309599225041 |Almera           |2    |\n|6591495892422696371_5655364103103594013|Juke             |2    |\n|4520779737860332716_7378383436555130718|March            |2    |\n|1869628052652578635_860014075187228075 |Note             |2    |\n|5490957852233757537_3764985658174107179|Note             |2    |\n|4425356829779113331_8639828637454462451|Note             |2    |\n|4946745176248140995_970379976759196923 |Note             |2    |\n|8280545361947039160_6766835808476526716|Juke             |2    |\n|461364693350231486_3939749271009417673 |Livina           |2    |\n|3647812150300005436_3880488845954950696|X-Trail          |1    |\n|5422935393747044181_1775789041362409756|X-Trail          |1    |\n|6457922579004881987_6253663094089520452|Navara_King_Cab  |1    |\n|5045662175703169637_3902455996839692450|Note             |1    |\n|6917530162049320918_3197179069035323090|Note             |1    |\n|6392184129167250980_6403632666369376358|Navara_Double_Cab|1    |\n|5499034117567717396_3613610355079219406|Juke             |1    |\n|6723731104367688728_4753886726757541257|Teana            |1    |\n|2909491611944750743_3477655517580163274|Note             |1    |\n|7938152266252614768_2590570779532262432|Note             |1    |\n|703372004673455489_515883250305150667  |X-Trail          |1    |\n|8779586551858546336_100072686008784396 |Note             |1    |\n|1431366345053021824_8299627917757540027|Sylphy           |1    |\n|7857434437578816354_3518151344133547075|X-Trail          |1    |\n|4302082539003384863_6526148849894556538|Teana            |1    |\n|7511781601502349646_2553915967850702277|X-Trail          |1    |\n|116844826242075499_4595855369718032906 |X-Trail          |1    |\n|8136148454524190563_6067997809206122950|Note             |1    |\n|4611687131360813466_3164996604210492765|Livina           |1    |\n|4854416892507012342_2055054601316335949|Note             |1    |\n|947772482860995203_2659778294851583052 |Note             |1    |\n|757163395813291056_5433261768293899438 |Note             |1    |\n|5083907776198873920_7153540939963536150|Juke             |1    |\n|4611687141024489410_3167989895766091066|X-Trail          |1    |\n|240221526435534831_6576057259406958205 |Livina           |1    |\n|6431123374932345478_7166290936628098008|Note             |1    |\n|2535272944129165562_3969957626269978338|X-Trail          |1    |\n|7901557536991564040_2535226822387084026|Note             |1    |\n|4029335603524902646_7642686123953434224|Navara_King_Cab  |1    |\n|6127341394149739100_7239464186814666757|X-Trail          |1    |\n|8120794977299697621_6378072742505046696|Navara_Double_Cab|1    |\n|8678724994938413015_4351551151069158232|Almera           |1    |\n|6096573522495968725_4294776482727482318|X-Trail          |1    |\n|4611689325016717453_3094693255202909764|Note             |1    |\n|6917530333311210462_3108115384484304092|Note             |1    |\n|7920315089675913925_673122151811935498 |X-Trail          |1    |\n|5796775618851663205_8780652102001544290|X-Trail          |1    |\n|2671170692148605609_6983638320083859112|Note             |1    |\n|1653573557273743885_767766069993542377 |Note             |1    |\n|1506825198010190972_1552683050730998026|Navara_King_Cab  |1    |\n|1982431732548551960_8992705846129724253|Note             |1    |\n|7754760032566305849_4760197091739096240|Juke             |1    |\n|4905700540510668142_566540620352346413 |Livina           |1    |\n|3276698022428233774_7967781821885705253|Livina           |1    |\n|5270588363271198851_1323007526540895732|X-Trail          |1    |\n|4742771715687710569_2951524435838483694|X-Trail          |1    |\n|736074020826650762_8457626134677125009 |Navara_Double_Cab|1    |\n|3751126490240476492_4561833942116888551|Almera           |1    |\n|7796592605290009938_8889429808448900623|X-Trail          |1    |\n|1382096084540506511_3592236522274622071|Navara_Single_Cab|1    |\n|3358337844165869124_5788227649743180739|X-Trail          |1    |\n|7486767712340519705_169150796250225788 |X-Trail          |1    |\n|7586578238612209444_5500221843735492363|Navara_King_Cab  |1    |\n|7202339809918917237_4818780119987730175|Pulsar           |1    |\n|3931355768154403410_9057411810615112360|Almera           |1    |\n|7569115741543896851_7333790115861997900|March            |1    |\n|5310414058489588553_3836429753862632478|Almera           |1    |\n|3734646110846711243_6749280034685460656|Teana            |1    |\n|1834760466612482207_8925319553997990483|Navara_Double_Cab|1    |\n|4290936923473757789_8288299667841421413|X-Trail          |1    |\n|4359888704909731796_4732942145768297851|Livina           |1    |\n|7113548016487597457_880626596751879846 |Note             |1    |\n|7515657743266850501_531983494773775243 |Note             |1    |\n|4931275195072619958_7751571026248512428|Teana            |1    |\n|5304033382787874276_6941204073574683679|X-Trail          |1    |\n|3539873819656815039_1095658774322386112|Almera           |1    |\n|5093883843560903504_5575580286681957972|Note             |1    |\n|2655138543464408562_7408262184338177418|Teana            |1    |\n|6569150891559940616_6207258553741353281|Juke             |1    |\n|6832861396336124819_1202069426883980446|Note             |1    |\n|6366584318204668182_2543070466132584184|Note             |1    |\n|2063771638741427950_2205218783667110650|Juke             |1    |\n|1135939517909951437_2244279529859248043|Juke             |1    |\n|9121597825861141701_2205796891353865687|March            |1    |\n|3778949054972290496_5466695545567162003|Note             |1    |\n|26906044613092646_4772338189193360536  |X-Trail          |1    |\n|4355834644674715827_8337170044162811699|Almera           |1    |\n|3938680276911432798_8764037672197731424|Note             |1    |\n|58208361691665132_8185277781765620798  |Note             |1    |\n|6021564688159425411_1073618532548967058|Teana            |1    |\n|3187046769287058042_8692271562662246758|Livina           |1    |\n|6144003300612296158_1920051643392127011|Juke             |1    |\n|8230934374574831072_2268258645274582794|March            |1    |\n|8906865129690920493_9119011218772842907|Note             |1    |\n|8899557764403167516_4900496558652581634|Livina           |1    |\n|6917532334765918567_3193802522513543750|Teana            |1    |\n|7551354579811800772_5826144128386183655|Note             |1    |\n|5429252524807883604_2529597734648027684|Note             |1    |\n|6726530559597886832_8836973355848012786|Note             |1    |\n|4611687263431075003_3208065662226950375|X-Trail          |1    |\n|1761552100420858558_5043282414138884601|Note             |1    |\n|9114829279519688410_8866370097839487548|Sylphy           |1    |\n|373624466472710178_5993799668740539553 |X-Trail          |1    |\n|4691317362774332394_581551460333140833 |X-Trail          |1    |\n|1235986405779855960_2670911880433200338|X-Trail          |1    |\n|6744062140615897238_3759098359909352158|X-Trail          |1    |\n|3052814414101414886_2488666332997768887|Note             |1    |\n|7356221644746908488_2378008473941260642|Pulsar           |1    |\n|1971229739294053268_2270822520284090513|X-Trail          |1    |\n|2692682321995762268_7854807322127104754|Note             |1    |\n|5124173825151447816_5782573511351272875|Note             |1    |\n|8803198854088039668_8799493576535877597|Note             |1    |\n|3854544143565339703_6345349409612158437|X-Trail          |1    |\n|5615025783984282959_209595812006256982 |Pulsar           |1    |\n|5986218675334069251_5431681398193153300|Navara_King_Cab  |1    |\n|8370080536487317539_8467838669585010345|Navara_Double_Cab|1    |\n|6917530155070377048_3038173708233092844|Teana            |1    |\n|6881743416595361889_2757503184707876790|Navara_Double_Cab|1    |\n|756219917284784595_5079503431310826967 |Pulsar           |1    |\n|258002064701358222_5058532304535223883 |Note             |1    |\n|256665745968287134_7881565971339600161 |Almera           |1    |\n|9189959710472561470_5642284890589912411|Note             |1    |\n|2916404551941173777_1979524001684111509|March            |1    |\n|6000113190164705981_1920251015663186566|Note             |1    |\n|2196886818832786361_7889764397490099221|Urvan            |1    |\n|2218901785117022892_3321125452828509947|Almera           |1    |\n|5030920951904998913_4737956422323368561|Juke             |1    |\n|7543393497386435169_137762635448250623 |Almera           |1    |\n|4287866208067477679_3819971891501196107|Almera           |1    |\n|2682800421169039186_88555944205091012  |X-Trail          |1    |\n|145005486131770217_5693028686347604958 |Navara_Double_Cab|1    |\n|8580833370195005992_3172234519650215235|Navara_Double_Cab|1    |\n|1367278926659482313_6709321922223970876|Livina           |1    |\n|6407009750884719207_2161968896201672579|X-Trail          |1    |\n|6738574019932398060_6795441817898599177|Note             |1    |\n|8133202245896478322_5322539068956530176|March            |1    |\n|7296885556393262102_5887859436730646248|Note             |1    |\n|7142283407666151407_7738838009618895135|Juke             |1    |\n|6050410906921909832_903904179209627029 |Juke             |1    |\n|8912910976153043_188770888230452043    |Note             |1    |\n|4361317422063941276_4766973133274638889|X-Trail          |1    |\n|7466233728189996961_769584454366212992 |Navara_King_Cab  |1    |\n|4502696784450039409_5252449368788380725|Note             |1    |\n|6124954470958692389_429910548726616179 |Note             |1    |\n|5020078842494959665_1160780931039746929|March            |1    |\n|1436013332654082491_1684758315559131392|Note             |1    |\n|9223010729161964948_5156126787263849634|Navara_Double_Cab|1    |\n|4611689321258397552_3110191258143468928|Note             |1    |\n|6917530131447906005_3158145562288198445|Note             |1    |\n|4333036289590463309_5881143625499259502|Juke             |1    |\n|8853500492355940738_932525402135011008 |Note             |1    |\n|4961769765347749482_7261283477345318349|Navara_King_Cab  |1    |\n|7771729664571248270_1213810907619626678|Note             |1    |\n|4287552615762020725_8191061760887887818|X-Trail          |1    |\n|6917532329397388899_3089677014721537631|Pulsar           |1    |\n|970247547682557686_3883110882247084085 |Note             |1    |\n|3568306860286042435_1702901569351856884|Note             |1    |\n|4611687123308141349_3184365474341852486|Teana            |1    |\n|4013429947215234243_4121748894769672749|Teana            |1    |\n|8978880366338742941_3592582797103177493|Almera           |1    |\n|6917530147017993747_3157244501771817492|X-Trail          |1    |\n|8617830967120691876_5494305421479091815|X-Trail          |1    |\n|6917532329934162459_3170415345402547862|Teana            |1    |\n|595198709957630490_4831480682803320470 |March            |1    |\n|3712278861328557861_760675246373884660 |Teana            |1    |\n|6572213590822128188_7260045530643113762|Sylphy           |1    |\n|4404712389400220224_1783091964757731813|X-Trail          |1    |\n|1254478702696516166_1191060637754800380|Navara_Double_Cab|1    |\n|4611705300683271141_3163369700658984890|X-Trail          |1    |\n|2232852373750336531_291511047653427350 |X-Trail          |1    |\n|6394762404241629683_4654354984474418719|Almera           |1    |\n|8699342698643735663_5485928670875401797|Sylphy           |1    |\n|8028672865252007106_4698400884287255372|X-Trail          |1    |\n|8123176516251212940_8324761069239836164|Note             |1    |\n|7142822560534442970_6389647391075465281|Navara_Double_Cab|1    |\n|5094123425340298863_3976420897401720249|Note             |1    |\n|6299456582790573093_5333674663757648474|Note             |1    |\n|2532782899436021113_5514992055938865982|X-Trail          |1    |\n|8361309007931211618_8154913074711728042|Teana            |1    |\n|4703740919115492583_6836342503562208642|Note             |1    |\n|1249595806243229959_5374481261870747409|Sylphy           |1    |\n|1580019842962724719_3224235789045604293|Urvan            |1    |\n|6206023735149852456_1710085328946792864|March            |1    |\n|7104916267117536371_6236273871956309386|Note             |1    |\n|1566390700822075516_4858247022185845465|Note             |1    |\n|1422638508506836264_9090740353902989176|Navara_Double_Cab|1    |\n|7972066947680369009_7714112883668966152|Almera           |1    |\n|4611689320183721920_3167520911107196981|Note             |1    |\n|5037167542543098629_6697774191971489212|X-Trail          |1    |\n|1491794838668627410_3121465731837602158|Note             |1    |\n|3239058484766638344_6883581507958000851|Teana            |1    |\n|6066933199629801950_7985181198724656590|Navara_King_Cab  |1    |\n|5354383807388974422_8205355386774242830|Juke             |1    |\n|7441709343377841276_2254514856058557880|Navara_Single_Cab|1    |\n|2656201146494591700_6425702799288285731|Note             |1    |\n|3853974457232646407_2852980391497221843|X-Trail          |1    |\n|7024194365024726878_7016040711799495088|Note             |1    |\n|6284978527724320751_4397381448846197308|Almera           |1    |\n|5868721899632505677_8085424102943987511|X-Trail          |1    |\n|1330224378154233791_3681490871208664060|Almera           |1    |\n|8817409101319954994_6688338323806400339|X-Trail          |1    |\n|1796966758193577165_5894795972612260843|Note             |1    |\n|2744630025445822419_4857690586663504943|Almera           |1    |\n|4303011865375027064_1681855672199747587|Navara_Double_Cab|1    |\n|3498852999596703895_6497067571562122004|Note             |1    |\n|4605896014954275520_2236626847786688173|Note             |1    |\n|4044098300504670697_8088231169978941330|Note             |1    |\n|2552812466021583289_5807978492351241832|Almera           |1    |\n|8451326714512389518_8051879574289182235|Pulsar           |1    |\n|6917535715978919344_3206278092542272186|Note             |1    |\n|1103276882828548379_2908721538614770584|March            |1    |\n|3294702280981590414_4742095362313353100|Juke             |1    |\n|2678533659894488537_7704946291030504621|Note             |1    |\n|6479419895975750569_1672794789302517781|March            |1    |\n|6917530229695156957_3170985796516319337|Almera           |1    |\n|5520083791394953164_4656986968969854617|Navara_Single_Cab|1    |\n|6768768576242982877_4722163986744841119|Note             |1    |\n|481040666851883964_4941017579497993874 |March            |1    |\n|6020250021938487698_6424835551685234850|Teana            |1    |\n|6631211569798680770_2827083965063577360|Navara_King_Cab  |1    |\n|6991309420666350224_2830085492070623773|Navara_Single_Cab|1    |\n|8499257732381137650_1806201569643936197|Note             |1    |\n|6679865597064374878_1203913792089811295|March            |1    |\n|2170312806700223580_419444801268465145 |Navara_Single_Cab|1    |\n|6601226211348050263_8903368941274505207|X-Trail          |1    |\n|794614123656452864_85653742029161185   |Almera           |1    |\n|3074635622530604224_3857909426132626579|X-Trail          |1    |\n|9093711262109902202_876213768210222092 |Note             |1    |\n|3560996207572345089_6413802511550467924|Navara_Double_Cab|1    |\n|8030506993039385922_2788334601996011320|Note             |1    |\n|5767407943556634760_8447811587870318956|Teana            |1    |\n|9089906282708173759_1774669965530510680|Teana            |1    |\n|5292780064509042267_472332739534897292 |March            |1    |\n|2079632807931465849_1735305236460504788|Teana            |1    |\n|290075482548314206_3614247398144606876 |Note             |1    |\n|6980006970668095353_8769715598955918964|Almera           |1    |\n|8969190916825781104_1200727952542615107|X-Trail          |1    |\n|2924700328532262844_6620797492788722036|Navara_Double_Cab|1    |\n|3318596760806559669_5344624529929890534|Note             |1    |\n|6917530144332587469_3188024238869718057|Note             |1    |\n|3046571532617891174_6210809205236368855|Livina           |1    |\n|4473939107774510316_8311231511136219453|Note             |1    |\n|1941641887676481871_6522988894969724526|X-Trail          |1    |\n|3403534630135838045_2460177189611572275|Note             |1    |\n|6917530226473914166_3187478393623554950|Note             |1    |\n|4623911064096407585_2304929391264098711|X-Trail          |1    |\n|5205980360540147595_7354036458482043594|X-Trail          |1    |\n|3523685156978983965_7073017155488538230|X-Trail          |1    |\n|1951911774842388604_3676186797513687379|Note             |1    |\n|2626704567176170052_6160309448617105076|X-Trail          |1    |\n|293932472677029080_4288797104916810654 |Almera           |1    |\n|7039666036031096496_3271230516040345301|X-Trail          |1    |\n|603730433352973447_1387619871564808463 |X-Trail          |1    |\n|3405117538122983041_2193875824136261546|X-Trail          |1    |\n|3710521109862836508_9153947072531647953|Almera           |1    |\n|8414686703613477727_5292342297803082483|Navara_Double_Cab|1    |\n|5687269394911758737_368019804074916046 |Almera           |1    |\n|4642720647392301607_3537403675570528898|Note             |1    |\n|2963524070086853435_8843950560799883795|Note             |1    |\n|4122256995933640893_1481094010038673931|Teana            |1    |\n|3972011364451353532_5902197589493792945|Note             |1    |\n|5693307240868231985_6125600077484607377|Note             |1    |\n|4572668575838407425_2068992987474850280|X-Trail          |1    |\n|1006526811327170406_3822624642450358843|March            |1    |\n|6424765321401837492_4879637286721829251|Note             |1    |\n|4458880892724536506_4187643295010803699|X-Trail          |1    |\n|209283437467767067_5741114492297329797 |Navara_Single_Cab|1    |\n|2597697141107332228_3779756037195487841|Note             |1    |\n|1793762118036144348_969262686904493943 |Urvan            |1    |\n|6576201781161592931_6913122227537119753|Navara_Single_Cab|1    |\n|2485089880692280574_5241023172038463511|X-Trail          |1    |\n|4808436008148644328_9130854442617305127|Note             |1    |\n|4998946424625439507_9084611885555328634|Almera           |1    |\n|6363999083965562588_4830584414508867987|Almera           |1    |\n|3306786007749109461_4001935592408441465|Almera           |1    |\n|8755829569274759236_1299718410870868907|Note             |1    |\n|4697336788297505274_6097946749885006937|Teana            |1    |\n|8007736879279952225_4781997594011400562|Pulsar           |1    |\n|2834838670046029197_3508770199473477861|Note             |1    |\n|7181983213808103578_7677672279309030934|Note             |1    |\n|391040556984267731_3069401204893280246 |Navara_Double_Cab|1    |\n|5500892257184176258_6989560882014856276|X-Trail          |1    |\n|6530062381210170631_5586340095064655551|Navara_Double_Cab|1    |\n|1301333434530187510_3926107217416189624|Almera           |1    |\n|6570328245378844908_2762595156811179132|Note             |1    |\n|604588371778083032_1749467028109466950 |Note             |1    |\n|8320612031351985270_598548863381835037 |Almera           |1    |\n|1835408854219755651_2128919744096696162|Note             |1    |\n|1849038918209574983_7102519861321377269|Note             |1    |\n|1376797046868160191_4302177406034212125|Sylphy           |1    |\n|8490529523330722315_3519262650865389083|Livina           |1    |\n|4428905259682199915_4134919872761573957|Note             |1    |\n|2127287470514230846_3898268405593141552|March            |1    |\n|984153428530050577_8054507157133891839 |Sylphy           |1    |\n|9144735556341195715_6803208380231360065|Almera           |1    |\n|7569112106890046027_2363136290557545000|Note             |1    |\n|1196190377000960517_5101198852510412616|X-Trail          |1    |\n|5212779019899868589_5567680610673399059|X-Trail          |1    |\n|8677836679034193553_363178668833387825 |Almera           |1    |\n|8857873963418097512_5556671774594209326|March            |1    |\n|5306249953520566406_2527911884563997093|Navara_King_Cab  |1    |\n|946437733592682607_5617614530750930975 |Note             |1    |\n|2424823186431326962_1292851626197707026|Note             |1    |\n|2966442665363927680_6918006751436523505|X-Trail          |1    |\n|6917532327787826965_3104714025937316324|Teana            |1    |\n|4475914806411907975_4609367947422001311|Almera           |1    |\n|3295844468515136206_4814234153898424705|Almera           |1    |\n|3480518803212879863_4863012040933212049|Navara_Double_Cab|1    |\n|4877048843336183931_2852258335734196024|X-Trail          |1    |\n|970247547682557686_3883110882247084085 |X-Trail          |1    |\n|1593572616910433725_1066710866302621833|Teana            |1    |\n|468415032445492860_733047893957131034  |Note             |1    |\n|4581769072847452593_157707231946916854 |Juke             |1    |\n|5429043430405042942_8038672668434559623|Navara_King_Cab  |1    |\n|3676484224986710970_7492405843051176780|Note             |1    |\n|3183719194412096579_6506461212545612313|X-Trail          |1    |\n|4611692648783361511_3171714283098162109|X-Trail          |1    |\n|7081208231273227236_5046513063920098725|X-Trail          |1    |\n|8178101671657095858_1120309048408547360|March            |1    |\n|1891130485139301778_9122901288338291990|Navara_King_Cab  |1    |\n|5763864412620575806_8537351533216925859|Sylphy           |1    |\n|5573031878100058239_1377514032526773116|March            |1    |\n|7638109104108914971_8701463187576268194|Note             |1    |\n|8331088624435382533_4190084506044812585|March            |1    |\n|8487309192977609539_3505483508041917907|Almera           |1    |\n|4611705279208310553_3207322723076488314|Almera           |1    |\n|6917530200704118853_3134304963332277740|X-Trail          |1    |\n|8280682674092950523_6364551644094329505|Note             |1    |\n|6868490588698043402_3325742514315663751|Navara_King_Cab  |1    |\n|144548093989496301_1298808199917189521 |X-Trail          |1    |\n|2081223748733330981_8529189526039518753|Navara_King_Cab  |1    |\n|4243070773228725669_5804870217759030771|Note             |1    |\n|6888714736000354743_4020837554976597522|Teana            |1    |\n|5763864412620575806_8537351533216925859|Teana            |1    |\n|6692868282103188144_2528651927160165438|Note             |1    |\n|2316690106911234036_6627912878301968266|Note             |1    |\n|969013663052079432_7720084759158014839 |Teana            |1    |\n|4129481971556727534_5515833172690613350|Livina           |1    |\n|3276183002522196707_5377813446201652947|Navara_Double_Cab|1    |\n|3672045262718984053_3161396107903029316|Sylphy           |1    |\n|6316839050455996840_5699198651567566135|Almera           |1    |\n|4902303594256117831_6168156465076334747|X-Trail          |1    |\n|2345408148642787764_8753271328600210403|Urvan            |1    |\n|8327089421622066823_4867154229804307304|Note             |1    |\n|598729054398216257_3865544037558580853 |Note             |1    |\n|4662003017766461702_9195399571574130413|Almera           |1    |\n|8689576201109617097_3171600873951482363|Teana            |1    |\n|4781701583446321046_6020438798666664535|Note             |1    |\n|2636071950619820917_8327966685385354800|Note             |1    |\n|1240501471463240335_2319083221600496342|X-Trail          |1    |\n|6442093655811898503_133183602820916401 |Note             |1    |\n|455713359180347150_6511694909318038949 |Navara_Double_Cab|1    |\n|8563162198131200899_41654702950507376  |March            |1    |\n|3418928792465183175_8716926996042790636|Note             |1    |\n|1576516161947063317_1543498244285823308|Teana            |1    |\n|5865767189892276305_149415258396345830 |Navara_Double_Cab|1    |\n|2348818028477941420_386235700240791319 |Note             |1    |\n|4611689326090805884_3147021008581080143|Note             |1    |\n|833475000026027372_5901339248920419491 |Navara_King_Cab  |1    |\n|2061635273701842856_2856888001697552572|Note             |1    |\n|2488463586600998432_7104934107545898394|X-Trail          |1    |\n|1048446308360186457_7590559697242302372|X-Trail          |1    |\n|8907063309531402369_8876372665574731780|X-Trail          |1    |\n|3432829071364285855_5684368161697577596|Navara_Single_Cab|1    |\n|439528885165253705_8682502435079100582 |Navara_King_Cab  |1    |\n|3407744404970699450_5869451254255347266|X-Trail          |1    |\n|9205786836065608838_1260882564241887300|March            |1    |\n|245994207698604738_8875058026892254536 |Note             |1    |\n|2642019548644988454_7115612353079230218|Juke             |1    |\n|3233185074753783114_1226266836161542786|X-Trail          |1    |\n|1566515903232534219_3242499721651613306|Navara_Double_Cab|1    |\n|6746825248502659229_2172860871261449524|Navara_Double_Cab|1    |\n|6815127069090217853_8427240052541591939|Sylphy           |1    |\n|4048675429559333074_2749051572110767607|Navara_Double_Cab|1    |\n|6773739328875507168_5756326503232407383|Almera           |1    |\n|8135705202651264059_6651952753856590104|Pulsar           |1    |\n|7055661186886783352_6807006018213951465|Teana            |1    |\n|8039434723367223321_186529293839018166 |Almera           |1    |\n|2082057000200142918_8871865697623747524|Navara_Double_Cab|1    |\n|2976886072222398503_7893721010991646405|Navara_King_Cab  |1    |\n|4159460293974637774_5017723613569276388|X-Trail          |1    |\n|6917530155607306392_3143321203493191645|Livina           |1    |\n|4296917519095370160_8259575166991117517|Navara_Single_Cab|1    |\n|8182773660931388394_606040082652070626 |X-Trail          |1    |\n|1318990496479053511_7397511805894641869|Almera           |1    |\n|3034261165273539460_807276793979901944 |Almera           |1    |\n|1830124950108978483_8002645190636430889|Note             |1    |\n|7425865331221488545_8408798634946061400|Note             |1    |\n|510414327503787015_2176884188191250505 |X-Trail          |1    |\n|2754399762090992914_3934019031031896739|Livina           |1    |\n|6917530137891175253_3139448148014534512|Almera           |1    |\n|6666724353002243365_7555530201009566797|Note             |1    |\n|1293115540620339461_3916067613943343021|Teana            |1    |\n|9065244596758148538_1406562958979641465|Note             |1    |\n|1422693672003695541_6211813203226973376|Navara_King_Cab  |1    |\n|8661953413750909532_205648432210717324 |X-Trail          |1    |\n|7888863553901273905_7492650682435740416|Note             |1    |\n|3739837971917535588_5718613815676697074|Teana            |1    |\n|574415651380729184_8870070663700644646 |Note             |1    |\n|504122521009503216_2462490724380867868 |Note             |1    |\n|7153099333346306271_9153682265688037942|Note             |1    |\n|2864435816496904853_6642917852101503992|X-Trail          |1    |\n|3928426760040962154_9173331858436611213|Note             |1    |\n|6298572812656836413_688297560882463542 |Sylphy           |1    |\n|6917530272644734574_3187792314930711911|Note             |1    |\n|489015889342945880_2497827545887566457 |Teana            |1    |\n|1416818143073688348_1665057006853405311|Note             |1    |\n|1288970665756424880_3700700105361201898|Navara_King_Cab  |1    |\n|2273324188482437867_628137870132446547 |X-Trail          |1    |\n|105408709324462728_1247469590732399496 |Pulsar           |1    |\n|5361518970779516036_3839113750648495000|Note             |1    |\n|9051065422461407464_8786762999201700047|Navara_Double_Cab|1    |\n|3550209556880649355_6352158678941787621|X-Trail          |1    |\n|7863831889084595367_559490705790677568 |Sylphy           |1    |\n|218564530251555800_4365928544144010128 |Navara_King_Cab  |1    |\n|6917530141648596009_3150733930499015999|X-Trail          |1    |\n|7561528437111043183_3245845160889720938|Note             |1    |\n|4436922813892770946_1124909426236243110|Note             |1    |\n|310990550233319496_4017292554800583303 |Juke             |1    |\n|6574728266559865354_1894284150818633981|Almera           |1    |\n|1834760466612482207_8925319553997990483|Teana            |1    |\n|666988770920075710_1794693360191388579 |X-Trail          |1    |\n|8389603556680329868_4096269566075060610|Almera           |1    |\n|3739837971917535588_5718613815676697074|Sylphy           |1    |\n|7942269921294158078_5711848448665640296|Almera           |1    |\n|2189405941811266156_5257031992322087259|X-Trail          |1    |\n|6131970644941202755_8211829517708198609|X-Trail          |1    |\n|6346646652777351524_7339992008494024239|Note             |1    |\n|3248079024293214188_2944710430456076267|Juke             |1    |\n|5705513246680925332_3265044769832140635|Navara_Double_Cab|1    |\n|8848028901592798780_2164669533943874543|March            |1    |\n|3506077926662781922_4003869015000525626|March            |1    |\n|1052677798990455172_8707988135601727700|Teana            |1    |\n|660445612929182369_1193296474859101064 |Almera           |1    |\n|4145537411973188997_8956283689911879718|X-Trail          |1    |\n|2388157665351148156_4591997481860289974|Livina           |1    |\n|9213927259199629917_5016082435537510145|Note             |1    |\n|7649708688355931363_477358454226217446 |Almera           |1    |\n|6917532334765913785_3164909100692320938|X-Trail          |1    |\n|283030635093136031_1187708044234644917 |Almera           |1    |\n|5371428416758913440_1954272264576869046|March            |1    |\n|6395088722932679302_4265976675868281429|Note             |1    |\n|4611689319646812088_3163397858467162014|Almera           |1    |\n|1307332091182510549_8297746194045547171|Almera           |1    |\n|1795499418411871635_9054475964919729915|X-Trail          |1    |\n|8476972903189914858_4276043370009701558|Navara_Double_Cab|1    |\n|5865767189892276305_149415258396345830 |X-Trail          |1    |\n|5530521192770210003_6897778835886102019|Note             |1    |\n|5679768432810740079_1038964119729379106|Sylphy           |1    |\n|8078413524726387832_2065813628049981993|Navara_Double_Cab|1    |\n|425598858908967394_4523085695300306191 |March            |1    |\n|442534542178953493_4559430124966080453 |X-Trail          |1    |\n|7116647001768508956_7845143683867479167|Note             |1    |\n|9138450244633584126_565639208473029673 |Navara_Double_Cab|1    |\n|6348144716253824223_1888137159528723424|X-Trail          |1    |\n|7026331299194153084_8833352578776877569|Almera           |1    |\n|7462418305342014920_8592273606969547831|X-Trail          |1    |\n|7481391276876973803_4643553042182016103|Almera           |1    |\n|1617689145406715455_8085194393231549346|Note             |1    |\n|2770310104549447371_3325825659460455615|Almera           |1    |\n|1917774425948263553_5347093572356719979|Sylphy           |1    |\n|7481005664341233256_1146421838918146968|Note             |1    |\n|6881524683839218442_4676013272495187138|X-Trail          |1    |\n|5770229834904713729_204173384919367951 |Pulsar           |1    |\n|3488433266659429255_1642409375580107945|Almera           |1    |\n|2271084957129753505_3803931479414284823|Note             |1    |\n|4611689319646676680_3150751945739384462|Juke             |1    |\n|7540435544977912254_962215269148163116 |Navara_King_Cab  |1    |\n|6923745832797765388_6353387567623570085|X-Trail          |1    |\n|4611687582869240477_3182430900811797010|X-Trail          |1    |\n|7045946165200702451_6116528037500672945|Navara_Double_Cab|1    |\n|4697292769305552079_6457395112804530156|Note             |1    |\n|8798594715576871442_8121261233392117421|Sylphy           |1    |\n|1375096879958296751_2945597772384105105|Almera           |1    |\n|5970484287154603172_3801609515106399840|Juke             |1    |\n|681268337280515216_1486686642820218158 |X-Trail          |1    |\n|7938313168920444463_8103418102495302073|Note             |1    |\n|3781533177958009853_8513370722917860518|March            |1    |\n|5872756079339150929_238235688880359005 |Almera           |1    |\n|6584135545065406714_1387667646651787650|Almera           |1    |\n|2886339599196114202_6201672214700955659|Note             |1    |\n|3786042849024202304_4708591729417617807|Note             |1    |\n|5978326631927182735_348608796150362066 |Note             |1    |\n|4634536430880387597_3824816728684652892|Pulsar           |1    |\n|8923995514812875175_1501952131467654951|Note             |1    |\n|4611689335752759630_3148962486270591767|Navara_Double_Cab|1    |\n|5835628424870323266_2503139585925362477|X-Trail          |1    |\n|5588981421151639272_8987461832869728203|Note             |1    |\n|4078870889446743786_6853407825595737419|Navara_King_Cab  |1    |\n|4686354506894314926_6798519372175508944|Almera           |1    |\n|8200992346824763934_2476631938563630962|March            |1    |\n|4623775354046518365_2027728545937682622|March            |1    |\n|3252530699298606906_4197231658678292698|X-Trail          |1    |\n|987554789857738496_3559512707518380452 |Almera           |1    |\n|9131567779254671131_9062186145777910587|Juke             |1    |\n|7477053130214259191_388171355968129464 |Juke             |1    |\n|5821478839879408123_4629975118431242674|Note             |1    |\n|7292372814081639552_4640280576741566424|X-Trail          |1    |\n|1016213697582317925_2131624107401753924|Note             |1    |\n|7595373381518691489_254893121210574375 |X-Trail          |1    |\n|4561570537603624698_8799684847296755506|X-Trail          |1    |\n|7618302649304205894_26645571280282967  |Note             |1    |\n|6449397635441162140_8662338450128685043|X-Trail          |1    |\n|7864397796049695542_263623860547913571 |Note             |1    |\n|451337741540964280_4348542833729536184 |Sylphy           |1    |\n|3958477769569875393_6454017488408237939|Teana            |1    |\n|1453020394889402783_4060347347847752317|Teana            |1    |\n|5142401325580863463_1523462143793910407|Teana            |1    |\n|4611705391951153944_3224025479375974297|Juke             |1    |\n|3268898887538514396_3414219278524159824|Juke             |1    |\n|7942269921294158078_5711848448665640296|X-Trail          |1    |\n|8663831503641899463_1750664777876147308|Almera           |1    |\n|5603592597661663153_1170832845358259786|Note             |1    |\n|8825092695013528381_7688443398651683686|X-Trail          |1    |\n|3270171405232951565_3962183940203376752|Note             |1    |\n|6650542842870293523_680165722460630406 |Note             |1    |\n|7903879816781966733_6882913230923958132|X-Trail          |1    |\n|5718251426561304414_1871903499328770457|Pulsar           |1    |\n|1793762118036144348_969262686904493943 |Note             |1    |\n|591568483132805778_7642488948707982628 |Navara_Double_Cab|1    |\n|8320612031351985270_598548863381835037 |X-Trail          |1    |\n|3996559249772946926_7527397937770780649|Note             |1    |\n|7227674355275120723_8340173611296077793|Juke             |1    |\n|3385517685980112524_5231723643080303011|X-Trail          |1    |\n|1712233796308214758_545761999042277225 |Almera           |1    |\n|2375803983008766295_8930411940939414782|Sylphy           |1    |\n|4808365222318814827_293720161135816490 |Navara_King_Cab  |1    |\n|5073524830953547144_1301321645421043079|X-Trail          |1    |\n|2091209312861731095_1399076740685293069|Livina           |1    |\n|8500824395867110217_4530590587810014468|Navara_King_Cab  |1    |\n|267353203053307614_6161820253857708343 |Note             |1    |\n|1578768186801700637_1233173771834121204|Sylphy           |1    |\n|4806955209565558574_4052102926172549475|Note             |1    |\n|438610833783317341_282414220637640073  |Almera           |1    |\n|6218930984214469277_8852830475560367718|Note             |1    |\n|4542660650329479342_3118901589234554929|Sylphy           |1    |\n|3047626791856856050_3527979987971831322|Navara_Double_Cab|1    |\n|6736068075357328554_4239265820247023861|Navara_Double_Cab|1    |\n|1221306722000504461_8196443610352493061|Teana            |1    |\n|5551593790531792073_6262510398367584427|Livina           |1    |\n|6990564003965582340_107527078738126110 |Pulsar           |1    |\n|6917532328323471376_3191629619101605821|Livina           |1    |\n|3545083267903235209_8077778569595250815|X-Trail          |1    |\n|3065167310274120837_2112144933647532478|Almera           |1    |\n|446425845327537191_7770100010780973301 |Note             |1    |\n|4366842320878846474_6304501653933207823|Note             |1    |\n|2121542039422833301_7579669359773627521|Note             |1    |\n|7824339300781176336_250409954272717193 |Note             |1    |\n|4917370393634032641_6306067543947524555|Juke             |1    |\n|332159639386599804_2354337533895257485 |Note             |1    |\n|8926649033975682676_8395038888420789155|Teana            |1    |\n|6623177472091069143_3250911768314247861|Sylphy           |1    |\n|6917530268886643058_3197883555341028365|March            |1    |\n|8949833137436400724_8487040004430515821|March            |1    |\n|4418711997750014637_7376194612106604294|Juke             |1    |\n|1859380053743763021_40737856651418923  |Note             |1    |\n|7273028640259704237_1787191388594327744|Note             |1    |\n|5938739453040239979_6452642782953154254|Note             |1    |\n|3042129749773406052_6284968439082355438|Livina           |1    |\n|8031946667210951266_5125850033599503155|Note             |1    |\n|2196886818832786361_7889764397490099221|X-Trail          |1    |\n|2905132282149066369_8255460374454086002|Almera           |1    |\n|5233953963834457679_7430762084807755095|Note             |1    |\n|6338586549373187193_3948600968621398677|Navara_King_Cab  |1    |\n|3216118436016248141_366731934085075243 |Note             |1    |\n|339314275418933455_6985995701820627007 |March            |1    |\n|6590132982024186936_2819375652372635699|Navara_Single_Cab|1    |\n|2847479064539690042_818902494709158046 |Note             |1    |\n|7069582129809869356_4020377935162482333|X-Trail          |1    |\n|2815249160848139936_4066936206653288370|Sylphy           |1    |\n|3450184625046508693_1564471547922748862|X-Trail          |1    |\n|3732858559439022986_7780269373619822851|X-Trail          |1    |\n|7917794489509099499_6510058728430522910|Almera           |1    |\n|3739077591861141491_152351946674999306 |X-Trail          |1    |\n|6652628979228298268_1406424256310428075|March            |1    |\n|5058249139484418177_8847591134400595605|Teana            |1    |\n|9066302128128856622_7479161446379703847|Urvan            |1    |\n|3901991929475564654_7336073586586722621|Note             |1    |\n|6244127437452040622_6209803394519108320|Teana            |1    |\n|7675336279296187826_8799234378063190948|X-Trail          |1    |\n|547233904321774830_6267526231707990293 |X-Trail          |1    |\n|3194943091472968412_534091992459878034 |X-Trail          |1    |\n|2087357620942637876_4394239999340352061|Almera           |1    |\n|5344218294952998770_1315475283437128978|Teana            |1    |\n|6979354321918549698_6705842472894415591|Note             |1    |\n|8281221540357009430_438291123471210681 |Note             |1    |\n|7785469741722594961_962636199079419291 |Juke             |1    |\n|5985731095210998209_7857595280299473741|Note             |1    |\n|9158988995268763144_7640663264402380585|X-Trail          |1    |\n|5134686717579869205_4490185855959315612|Navara_King_Cab  |1    |\n|3035039679209965844_5942768310491897114|Almera           |1    |\n|3826338891376843762_6988508603446291273|Note             |1    |\n|8554967030749358025_8776576806531336315|Almera           |1    |\n|4792681460876153613_1735215984773677447|Livina           |1    |\n|5222614143531569480_8858186635109159844|Note             |1    |\n|8151416826587857661_8505629545349331781|Navara_Double_Cab|1    |\n|3185396062075634851_4436505146475950813|Pulsar           |1    |\n|6721933520927321210_7925445448944283730|March            |1    |\n|4580944988133741759_6726995298074673738|Note             |1    |\n|2487416062925710226_5041224825954151391|Note             |1    |\n|7881182705596410144_7798560394989516295|March            |1    |\n|1465980403321674163_1843446520363952880|Sylphy           |1    |\n|2997140518774913037_7029396115250266292|Note             |1    |\n|4870569483551322700_4391185371300213650|X-Trail          |1    |\n|8413236671393645185_4957944847268694145|X-Trail          |1    |\n|5082820070550524205_7987376727259669752|Note             |1    |\n|3208345080714711787_2244803297027394188|Almera           |1    |\n|2127800839606298152_7692698499099504900|Sylphy           |1    |\n|3707257744410046553_386310788765023144 |Sylphy           |1    |\n|1685393663594583888_4689985010789888185|X-Trail          |1    |\n|8724307447318155271_4551902056430303676|Note             |1    |\n|2298565733358662383_4587815386371036295|Juke             |1    |\n|6964756969876753470_7933332838550767498|Note             |1    |\n|3444400185318066845_4711044618468914302|Navara_King_Cab  |1    |\n|8846194181972117326_1783655713449557085|Navara_Double_Cab|1    |\n|3346646435314052767_603644994434100630 |Livina           |1    |\n|4973144107908429579_7794246965516985156|Sylphy           |1    |\n|431364705694281221_7285303991738701288 |X-Trail          |1    |\n|27921973873407475_2422240386699737730  |Almera           |1    |\n|7203989452325536334_3202878232512469589|Note             |1    |\n|5764718232768814650_85650038990819549  |Almera           |1    |\n|244483395644592436_8647954466497054503 |X-Trail          |1    |\n|7322485962150840451_3652399832412903742|Note             |1    |\n|2693358460337990444_6269018831795939268|Note             |1    |\n|8302808639934093778_5108943252200179095|Note             |1    |\n|4515655165875190651_3637769795792051780|Note             |1    |\n|4611689318036030846_3211482328038283389|Juke             |1    |\n|7985036564598781130_1029665266851761254|Juke             |1    |\n|6581454493883107054_2885046142177907445|Juke             |1    |\n|6917530155607069491_3158024315361888171|X-Trail          |1    |\n|7634998663789220435_6021806557462329121|March            |1    |\n|3485647387468978685_7159280079905649516|Navara_Double_Cab|1    |\n|3161629922264810898_7968675215626981584|Note             |1    |\n|3049487405108168947_1978109069382618840|Navara_Double_Cab|1    |\n|5035685205365439679_3637719203246571624|Navara_Double_Cab|1    |\n|6204520129478199440_4690487077900453058|Note             |1    |\n|5142126758982412859_1959788801527221152|Almera           |1    |\n|3208879906376635783_4919813105864083531|March            |1    |\n|1851163327781771660_3170457969308016240|X-Trail          |1    |\n|4230963941831472983_5567592165128092654|Almera           |1    |\n|7739597869350278983_7643362577868903961|X-Trail          |1    |\n|291222986441167298_7295693639864134748 |Navara_Double_Cab|1    |\n|2990160223178885075_2950619579962578145|Note             |1    |\n|5614216915529350767_3303306289787999673|March            |1    |\n|4536368465957501706_6525982183644992064|Note             |1    |\n|7798695198665595100_19367516439106276  |Note             |1    |\n|3269004467274931993_2822805771189255504|Note             |1    |\n|3767082529182917760_3537093083267199594|Note             |1    |\n|6137126441715866192_5514576715650189484|Sylphy           |1    |\n|6917530172787090209_3178317756662168017|Navara_King_Cab  |1    |\n|1552685760657061238_637210837292065164 |Note             |1    |\n|5265692727210012525_756201307209100352 |Note             |1    |\n|7712008906796155040_4772145856282228531|X-Trail          |1    |\n|6062824314830205216_6047157297735216370|Sylphy           |1    |\n|6917532328323603481_3159164996398265513|Juke             |1    |\n|2088871061756640550_8268050742412639531|Note             |1    |\n|1536656530326518252_2679815757615764163|Note             |1    |\n|3481183114133892597_4020088600783873565|X-Trail          |1    |\n|2054173483268211702_148605966473077413 |Navara_Double_Cab|1    |\n|7738462089826689460_6059378953076537675|Sylphy           |1    |\n|4611687190953808023_3145930731132946986|X-Trail          |1    |\n|5837853899921072041_919146228402285680 |Navara_King_Cab  |1    |\n|7438048734080477255_3076519629135208889|Note             |1    |\n|4046322308525398801_3631869218092296650|Note             |1    |\n|7458859767595686677_1603938041286335345|X-Trail          |1    |\n|1638390918712109267_3372727259785208676|Almera           |1    |\n|6917532328860470135_3142346071970845524|Almera           |1    |\n|345429137104297322_5628640863790022845 |X-Trail          |1    |\n|1862635943041343997_4799558724383506944|X-Trail          |1    |\n|6333483237494903292_1852354144149052376|X-Trail          |1    |\n|1684631907756056290_8308179682279723122|Note             |1    |\n|7204250499127436802_1242295086747456731|Note             |1    |\n|3309244051391907923_2129763692662775497|Navara_King_Cab  |1    |\n|2528358224150058400_6311017030546284116|Teana            |1    |\n|512867152537660930_3201546530309044817 |Note             |1    |\n|5969535847104474924_5187763346045514667|X-Trail          |1    |\n|3918140391122333732_5560743585201000771|March            |1    |\n|1939624557710400644_2962437284509805308|Juke             |1    |\n|6465064802867454134_8126265007318384021|Note             |1    |\n|8916125278095910137_3368942464250323553|Pulsar           |1    |\n|6708710727931927730_6389734384022038460|Pulsar           |1    |\n|4366214471509029338_8846289609781498166|Note             |1    |\n|6612635763533490564_3877565671792950112|Note             |1    |\n|7175036097466516953_1142001976996588766|X-Trail          |1    |\n|1834760466612482207_8925319553997990483|March            |1    |\n|6149536128606324407_7343109969917045551|Navara_Double_Cab|1    |\n|4534515735588475731_6580717900829056979|X-Trail          |1    |\n|4611689327165973432_3028348397165384237|Note             |1    |\n|447059633967702337_7736507539224680925 |Almera           |1    |\n|6713710465314682888_7096308283583534230|Sylphy           |1    |\n|8855582412862512900_6589839922941179074|Almera           |1    |\n|6989989863546536348_1265454369591769147|X-Trail          |1    |\n|4454110277624747639_2581472495946232623|Teana            |1    |\n|2529040063978529465_2322527249725238943|Note             |1    |\n|8674738048251786622_9034207451965470668|X-Trail          |1    |\n|1222426930266648032_3526318831029549132|Almera           |1    |\n|6296119995944872147_727143608624489752 |X-Trail          |1    |\n|806612733563434904_8097874753204234488 |Navara_Double_Cab|1    |\n|87450200489481505_749135009435895069   |Note             |1    |\n|1498675544469599451_5656698674569445741|Navara_Double_Cab|1    |\n|6433671518960132017_522858670382223354 |Navara_Single_Cab|1    |\n|493005878810249564_5641269586551843307 |March            |1    |\n|1865411697137708761_6287209182645857300|Navara_King_Cab  |1    |\n|8133528913163405195_969393097042348412 |Navara_Double_Cab|1    |\n|6625288697232006032_722875249199516941 |Note             |1    |\n|1565661764342816880_7412323455666100346|Sylphy           |1    |\n|4833842074929036627_1348374421499836520|March            |1    |\n|3417682054045459070_5368086072019986770|Almera           |1    |\n|289177427659939632_859696812615576698  |Almera           |1    |\n|3699501513723140322_8021423574489333985|March            |1    |\n|8486057960226437973_1091281338311904350|Juke             |1    |\n|5601414309613890313_7333530181139872913|Teana            |1    |\n|8200449209638680118_4811297996158960756|March            |1    |\n|2510734697839279118_8132314666469583323|X-Trail          |1    |\n|2081100599046613031_874222233582282945 |Almera           |1    |\n|869199703529346303_8228241495752475270 |March            |1    |\n|7895398079508386983_6532582845832588992|Juke             |1    |\n|3383170220224894919_6835982776360029208|Note             |1    |\n|2220461044537746811_1432270970052635381|X-Trail          |1    |\n|2226224407494729420_8098159402105649320|Juke             |1    |\n|7796974406782007993_6303071846300662140|Pulsar           |1    |\n|1933009832197081489_1458134305324175417|Teana            |1    |\n|6917530200167194304_3167993033239707141|Note             |1    |\n|4940052471612687560_2341884349217876871|Navara_Double_Cab|1    |\n|6917548302380651874_3172711512225816779|March            |1    |\n|6236032110089716102_8988386661254250759|Note             |1    |\n|4870890425326201129_190719886422535334 |Note             |1    |\n|222736642990777463_7071125672932407303 |Teana            |1    |\n|6917530189966762722_3065944767050353287|Navara_Double_Cab|1    |\n|5525691565864859530_8841603960577948165|Note             |1    |\n|6613238435718833170_6074961327991401565|March            |1    |\n|6200182155093028435_7058300197465064767|Note             |1    |\n|4302358716264767693_6920345130056910097|Almera           |1    |\n|8911324077948436126_8005107874122721300|X-Trail          |1    |\n|5502586268957033230_3969638759429240830|Navara_Double_Cab|1    |\n|6917532331544674673_3173774555288871067|Livina           |1    |\n|1985706197455977322_578726189900893112 |Almera           |1    |\n|5292780064509042267_472332739534897292 |Note             |1    |\n|7201319583784907159_764018344475495293 |Juke             |1    |\n|2497839943755544854_5142928450091080709|Navara_Double_Cab|1    |\n|8377991065927881195_5282557046055621816|X-Trail          |1    |\n|1291153699979437119_7241904713041231976|X-Trail          |1    |\n|4611687151225061240_3177108235886855200|Note             |1    |\n|8531384820616684296_1946367566629014175|Note             |1    |\n|5731266380279268653_8775200511352956796|X-Trail          |1    |\n|8004071273538548444_4919742819083735998|X-Trail          |1    |\n|2309469036504663969_4723109153700608428|X-Trail          |1    |\n|6377024428319144677_3147804984478385706|X-Trail          |1    |\n|1960270172249194348_7874678429322835609|Pulsar           |1    |\n|2557421962940081582_7477670175038677811|X-Trail          |1    |\n|2769885589426309349_3846699666503682690|March            |1    |\n|5543973210986823435_3488694803189526969|X-Trail          |1    |\n|9091413617766187290_2767860350854532805|Navara_Double_Cab|1    |\n|2175617972327799938_6845112352961866204|Sylphy           |1    |\n|4597730995533649775_1702523423797163147|X-Trail          |1    |\n|4319231679781035145_9020376177285843665|X-Trail          |1    |\n|6137612649530906634_4126427066890466404|Navara_King_Cab  |1    |\n|4345451750407547377_5509469445535658027|X-Trail          |1    |\n|2383271389583927490_1421055417081344753|March            |1    |\n|4983438341467312352_7116344976307538064|Juke             |1    |\n|4582378097168804497_442052833574465656 |X-Trail          |1    |\n|919751411387803969_3709873084419658842 |Note             |1    |\n|4611687152300005369_3015853192692506082|X-Trail          |1    |\n|7901286802157660794_4778578941343479997|Juke             |1    |\n|5449160064535114189_6445129816889352199|Navara_Double_Cab|1    |\n|769696458795737891_5359069126383464048 |Note             |1    |\n|5478454021030041067_8178820717093973787|Navara_Double_Cab|1    |\n|1372087086185422351_2046911180322449926|Note             |1    |\n|4810018715515812931_4596801674912052979|Almera           |1    |\n|4593658586452360672_776159198623592114 |Sylphy           |1    |\n|6048089430282369864_2217861289353307121|X-Trail          |1    |\n|2950578256738167087_6303990448079783700|Note             |1    |\n|8962905033204633067_4661157487858266360|X-Trail          |1    |\n|2774231548505765353_2162924552250190260|X-Trail          |1    |\n|8985196434457737944_5175618717781047202|Teana            |1    |\n|8899056836773371425_2225005558000333417|Juke             |1    |\n|3508896777028473844_6384893631888118953|Navara_Double_Cab|1    |\n|2407915784943248972_6383507936074456854|X-Trail          |1    |\n|1021973699469146731_258814647989230612 |Note             |1    |\n|7732800383925911696_7537923330500920428|Note             |1    |\n|2189256933380775979_1900401641472206202|Teana            |1    |\n|8401682673458070080_7597344159685286952|Note             |1    |\n|6048884747908709616_6275360468689994413|Almera           |1    |\n|1787834654275965771_7899975595301869449|Almera           |1    |\n|7082262740281944527_8879216129331516178|X-Trail          |1    |\n|1785473361346523454_1550764178755279043|Teana            |1    |\n|1994914480439902694_6526574266035040621|Note             |1    |\n|4997987193106220097_3706096337680059047|X-Trail          |1    |\n|1252535034180594919_5684297998082629435|Juke             |1    |\n|3240198871098524296_5248430709555151846|Almera           |1    |\n|3773201033555840572_8019268903914206232|Note             |1    |\n|3346867347067990596_2077877953364003115|Note             |1    |\n|8126149151024344777_5160629843644566890|X-Trail          |1    |\n|703372004673455489_515883250305150667  |Teana            |1    |\n|1814308198527116472_8452197785839576227|Juke             |1    |\n|3725638766768007906_412724836593932180 |X-Trail          |1    |\n|2308446466632169955_8025240430167149018|Note             |1    |\n|6119487817458978648_1436033566031359589|Teana            |1    |\n|7277025482174812006_1590122627216209328|X-Trail          |1    |\n|6178338388691187114_5318280169894590205|Teana            |1    |\n|4047133503571564606_3871234858807398644|Note             |1    |\n|1618053275140417697_4773249065524657064|Navara_Double_Cab|1    |\n|1744528140112453077_4871114423264361385|X-Trail          |1    |\n|4980678532360049490_2305192893463897345|Navara_Double_Cab|1    |\n|7543393497386435169_137762635448250623 |Navara_Double_Cab|1    |\n|5139519082147961319_2266936882579310173|X-Trail          |1    |\n|4195491498109560157_7979883452688998491|X-Trail          |1    |\n|1923164509248392113_789805812680336726 |Note             |1    |\n|4611689322331096898_3159132468463442468|Sylphy           |1    |\n|3923574530872544713_4350507198761870741|Juke             |1    |\n|7955980953003366153_169651586620059307 |Note             |1    |\n|3500405895234237528_2266601296323574938|Almera           |1    |\n|8033261478789451007_7222587164996025923|X-Trail          |1    |\n|4788239422502161904_4667014047997979328|Almera           |1    |\n|261030481811209553_5019862971838507097 |Navara_King_Cab  |1    |\n|4959843731435853539_3339087731293028155|Note             |1    |\n|1679385188831656214_6760398423367667364|Almera           |1    |\n|3728233976320507025_228772996175978782 |Note             |1    |\n|2818030151655828236_4730944191581731365|Note             |1    |\n|8466629818673261983_4865458813633176566|Almera           |1    |\n|6917548299159401370_3216978112353091127|Teana            |1    |\n|3394684543194526521_5783846500959879155|Note             |1    |\n|2069619030133565296_4111672443020159591|Navara_King_Cab  |1    |\n|1449444849722509648_499859416968457083 |Navara_Double_Cab|1    |\n|4358763166710368092_173443556189997626 |X-Trail          |1    |\n|4699934372571178316_7247707712863332879|Note             |1    |\n|1739276651506212997_4303668751005205972|Note             |1    |\n|1015154942960018122_9206042461826971593|Livina           |1    |\n|2924753135009316445_1705445346190762463|X-Trail          |1    |\n|3969566010752552138_1553832885054847187|Sylphy           |1    |\n|1233612258935986870_3926484019334350470|Teana            |1    |\n|3250360099862753703_8572950705536928916|Note             |1    |\n|5869103030942893821_6964795576869385860|X-Trail          |1    |\n|2547025309529666106_4382549325158573257|X-Trail          |1    |\n|3576069376889289915_2564770786133174638|Navara_Double_Cab|1    |\n|3626529513013216986_5530329860586280840|X-Trail          |1    |\n|2932982937823403148_8140736595804423002|Navara_King_Cab  |1    |\n|2291672098550931930_8394757022675031381|Juke             |1    |\n|2364992935442883032_1086083794025215654|Almera           |1    |\n|1311691086704790747_3169775168625396592|Note             |1    |\n|6917532327786663919_3123552467610010806|Note             |1    |\n|4853335925422199838_7583744913548253692|X-Trail          |1    |\n|6462818548396922765_2716481425195095608|Teana            |1    |\n|804514731159002690_7055500487051826526 |Teana            |1    |\n|5911711333886246406_2520624974555648186|X-Trail          |1    |\n|8138155619776434845_3250118143308125397|X-Trail          |1    |\n|5118829148917216010_7665813863166389472|Navara_Double_Cab|1    |\n|1330955506352154685_691259290118045823 |Almera           |1    |\n|5900500691455585591_3534372896818422135|Livina           |1    |\n|5289558038641392467_3352901141897235388|X-Trail          |1    |\n|6983863250816372054_6230363555621177534|Navara_Double_Cab|1    |\n|8579841266772750616_1319383069116268565|Note             |1    |\n|5523503655393083436_7538288637038559092|X-Trail          |1    |\n|726689677609704590_6864782403037961426 |Navara_Double_Cab|1    |\n|7405488451565545556_8209965806843658045|X-Trail          |1    |\n|7867757554964633995_6367573683257336519|Note             |1    |\n|2406111327109107643_7961830401262901837|Note             |1    |\n|7929393383393868296_3265245211209069   |Note             |1    |\n|930817852382801665_1772834877009076678 |Note             |1    |\n|4229981617330966443_4219435296385164943|Juke             |1    |\n|7307397675239295922_8821603404788523559|Teana            |1    |\n|7296258540428323282_5243221763594912684|Note             |1    |\n|2862055317581130664_3546005515370802661|Juke             |1    |\n|1209802510861052055_1628208597213249046|Note             |1    |\n|7349737552294165088_7945679292955740659|Note             |1    |\n|6820870440393927998_3507122448745653037|Navara_King_Cab  |1    |\n|5530896835005529742_3111929442530480302|X-Trail          |1    |\n|7161059846090222350_7056697013670487496|Navara_Double_Cab|1    |\n|1329238577867323755_2992948657909365043|Teana            |1    |\n|6069675081596889884_7892382193819892554|Juke             |1    |\n|969386435422503158_1351290953408809629 |March            |1    |\n|772631385380397861_1137959047064197155 |Navara_Double_Cab|1    |\n|3034117885283907814_7158624095254763367|X-Trail          |1    |\n|6109927150821933882_4304312358764113814|Note             |1    |\n|4629178313952940744_1221963071504575549|Pulsar           |1    |\n|6985584190856354434_7320069080951486829|Almera           |1    |\n|6917532331545625074_3163892234972734382|Juke             |1    |\n|7749432202070881057_106377992316271007 |Sylphy           |1    |\n|7427375041936895069_1311420135219349528|Note             |1    |\n|4452036528597320432_9041593778027915728|Note             |1    |\n|4703740919115492583_6836342503562208642|X-Trail          |1    |\n|1244574103355186773_2564932401888992341|Teana            |1    |\n|800493199684670879_1426893498325477642 |Note             |1    |\n|7507633687029327476_2166976363506528315|Note             |1    |\n|6692363202048133293_8284987917579249758|Teana            |1    |\n|4072978389304505069_5252571631394683104|Note             |1    |\n|4882412349184583251_5217189259830069630|X-Trail          |1    |\n|3034675420529574881_6275920747659299591|March            |1    |\n|1867413612182919764_3985337559368241906|X-Trail          |1    |\n|1313044998624866334_8748671633882127925|Urvan            |1    |\n|8993182024895970073_378729639676659942 |Navara_Double_Cab|1    |\n+---------------------------------------+-----------------+-----+\nonly showing top 1000 rows\n\n"}]},"apps":[],"jobName":"paragraph_1535094673818_1684309896","id":"20171104-061322_511281760","dateCreated":"2018-08-24T07:11:13+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3457"},{"text":"%pyspark\ndf_hits_with_booked_car_model.filter(col('visitor_id') == '8189216412116469441_7536395945900584875').filter(col('success_event_201') == 1).select('date_time_ts','booked_car_model','post_evar6','success_event_201').show(1000,False)","dateUpdated":"2018-08-24T07:11:13+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------------------+----------------+----------+-----------------+\n|date_time_ts       |booked_car_model|post_evar6|success_event_201|\n+-------------------+----------------+----------+-----------------+\n|2017-02-04 15:54:20|Juke            |P12C      |1                |\n|2017-02-05 08:49:52|Juke            |P12C      |1                |\n|2017-02-05 08:50:47|Juke            |P12C      |1                |\n|2017-02-05 11:10:48|Juke            |P12C      |1                |\n|2017-02-05 12:54:02|Juke            |P12C      |1                |\n|2017-02-05 12:55:50|Juke            |P12C      |1                |\n|2017-02-05 12:58:30|Juke            |P12C      |1                |\n|2017-02-05 20:04:00|Juke            |P12C      |1                |\n+-------------------+----------------+----------+-----------------+\n\n"}]},"apps":[],"jobName":"paragraph_1535094673819_1683925147","id":"20171104-061414_37509477","dateCreated":"2018-08-24T07:11:13+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3458"},{"text":"%pyspark\ndf_hits_with_booked_car_model.select('is_converted').groupBy('is_converted').count().show(10, False)\n","dateUpdated":"2018-08-24T07:11:13+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------------+-------+\n|is_converted|count  |\n+------------+-------+\n|null        |13238  |\n|1           |19728  |\n|0           |9726719|\n+------------+-------+\n\n"}]},"apps":[],"jobName":"paragraph_1535094673819_1683925147","id":"20171104-062600_625079141","dateCreated":"2018-08-24T07:11:13+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3459"},{"text":"%pyspark\ndf_hits_with_booked_car_model.printSchema()","dateUpdated":"2018-08-24T07:11:13+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- accept_language: string (nullable = true)\n |-- browser: string (nullable = true)\n |-- country: string (nullable = true)\n |-- visitor_id: string (nullable = true)\n |-- visit_unq: string (nullable = true)\n |-- visit_num: string (nullable = true)\n |-- visit_page_num: string (nullable = true)\n |-- post_event_list: string (nullable = true)\n |-- post_pagename: string (nullable = true)\n |-- post_page_url: string (nullable = true)\n |-- post_page_event: string (nullable = true)\n |-- post_zip: string (nullable = true)\n |-- hit_source: string (nullable = true)\n |-- exclude_hit: string (nullable = true)\n |-- hit_time_gmt_str: timestamp (nullable = true)\n |-- first_hit_page_url: string (nullable = true)\n |-- first_hit_pagename: string (nullable = true)\n |-- first_hit_referrer: string (nullable = true)\n |-- first_hit_time_gmt: string (nullable = true)\n |-- ip: string (nullable = true)\n |-- last_hit_time_gmt: string (nullable = true)\n |-- post_keywords: string (nullable = true)\n |-- post_referrer: string (nullable = true)\n |-- post_search_engine: string (nullable = true)\n |-- ref_domain: string (nullable = true)\n |-- state: string (nullable = true)\n |-- user_agent: string (nullable = true)\n |-- weekly_visitor: string (nullable = true)\n |-- yearly_visitor: string (nullable = true)\n |-- visid_type: string (nullable = true)\n |-- post_cust_hit_time_gmt: string (nullable = true)\n |-- post_evar4: string (nullable = true)\n |-- post_evar5: string (nullable = true)\n |-- post_evar6: string (nullable = true)\n |-- post_evar7: string (nullable = true)\n |-- post_evar8: string (nullable = true)\n |-- post_evar9: string (nullable = true)\n |-- post_evar20: string (nullable = true)\n |-- post_evar19: string (nullable = true)\n |-- post_evar21: string (nullable = true)\n |-- post_evar22: string (nullable = true)\n |-- post_evar29: string (nullable = true)\n |-- post_evar30: string (nullable = true)\n |-- post_evar32: string (nullable = true)\n |-- post_evar34: string (nullable = true)\n |-- post_evar39: string (nullable = true)\n |-- post_evar40: string (nullable = true)\n |-- post_evar41: string (nullable = true)\n |-- post_evar48: string (nullable = true)\n |-- post_evar54: string (nullable = true)\n |-- post_evar61: string (nullable = true)\n |-- post_evar64: string (nullable = true)\n |-- post_prop1: string (nullable = true)\n |-- post_prop2: string (nullable = true)\n |-- post_prop3: string (nullable = true)\n |-- post_prop4: string (nullable = true)\n |-- post_prop5: string (nullable = true)\n |-- post_prop6: string (nullable = true)\n |-- post_prop7: string (nullable = true)\n |-- post_prop12: string (nullable = true)\n |-- post_prop14: string (nullable = true)\n |-- post_prop16: string (nullable = true)\n |-- post_prop17: string (nullable = true)\n |-- post_prop23: string (nullable = true)\n |-- geo_country: string (nullable = true)\n |-- geo_city: string (nullable = true)\n |-- date_time_ts: timestamp (nullable = true)\n |-- date_ts: timestamp (nullable = true)\n |-- success_event_201: integer (nullable = true)\n |-- is_converted: integer (nullable = true)\n |-- session_id: long (nullable = true)\n |-- hit_rank_reversed: integer (nullable = true)\n |-- time_spent_in_mins: float (nullable = true)\n |-- page_category: string (nullable = true)\n |-- device_type: string (nullable = true)\n |-- booked_car_model: string (nullable = true)\n\n"}]},"apps":[],"jobName":"paragraph_1535094673820_1682001403","id":"20171109-173651_1785966254","dateCreated":"2018-08-24T07:11:13+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3460"},{"text":"%pyspark\n\n# Caching the dataframe\ndf_hits_with_booked_car_model.createOrReplaceTempView('df_hits_with_booked_car_model_view')\nspark.catalog.cacheTable('df_hits_with_booked_car_model_view')\nspark.table('df_hits_with_booked_car_model_view').count()","dateUpdated":"2018-08-24T07:11:13+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"9759685\n"}]},"apps":[],"jobName":"paragraph_1535094673820_1682001403","id":"20171104-070211_250817957","dateCreated":"2018-08-24T07:11:13+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3461"},{"text":"%pyspark\ndf_hits_with_booked_car_model_final = spark.table(\"df_hits_with_booked_car_model_view\")\nprint(df_hits_with_booked_car_model_final.count())","dateUpdated":"2018-08-24T07:11:13+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"9759685\n"}]},"apps":[],"jobName":"paragraph_1535094673820_1682001403","id":"20171104-070923_1787663836","dateCreated":"2018-08-24T07:11:13+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3462"},{"text":"%pyspark\ndf_hits_with_booked_car_model_final.rdd.getNumPartitions()","dateUpdated":"2018-08-24T07:11:13+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"50\n"}]},"apps":[],"jobName":"paragraph_1535094673821_1681616654","id":"20180212-100132_301944422","dateCreated":"2018-08-24T07:11:13+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3463"},{"text":"%pyspark\n\nparquet_write_file_path =  r's3n://s3-helios-nissan-ml-poc/nissan-id/data/processed/v4'\ndf_hits_with_booked_car_model_final.write.format('parquet').save(parquet_write_file_path)","dateUpdated":"2018-08-24T07:11:13+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1535094673821_1681616654","id":"20171104-071733_405445906","dateCreated":"2018-08-24T07:11:13+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3464"},{"text":"%pyspark\n","dateUpdated":"2018-08-24T07:11:13+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1535094673821_1681616654","id":"20180219-082257_128394200","dateCreated":"2018-08-24T07:11:13+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3465"}],"name":"sample-data-processing","id":"2DPCPZRYP","angularObjects":{"2DNU7GJ1X:shared_process":[],"2DPHP1RV2:shared_process":[],"2DR58WJ2Z:shared_process":[],"2DNE86QUA:shared_process":[],"2DRHJMKF1:shared_process":[],"2DNDXD12J:shared_process":[],"2DNHUWTEZ:shared_process":[],"2DQMQ7YUT:shared_process":[],"2DNE12NH9:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}